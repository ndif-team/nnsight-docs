
<!DOCTYPE html>


<html lang="en" data-content_root="../../" data-theme="dark">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>The Geometry of Truth &#8212; nnsight</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "dark";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "dark";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/mini-papers/marks_geometry_of_truth';</script>
    <script src="../../_static/js/custom.js?v=1e4be224"></script>
    <script src="../../_static/js/code.js?v=34343d0c"></script>
    <link rel="icon" href="../../_static/icon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Function Vectors" href="todd_function_vectors.html" />
    <link rel="prev" title="Do Language Models Use Their Depth Efficiently?" href="csordas_llm_depth.html" />

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
<link href="../../_static/css/custom.css?v=1752601597" rel="stylesheet" type="text/css" />
<link href="../../_static/css/home.css?v=1752601597" rel="stylesheet" type="text/css" />

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="dark">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
    
    <img src="../../_static/nnsight_logo.svg" class="logo__image only-dark" alt="nnsight - Home"/>
    <img src="../../_static/nnsight_logo.svg" class="logo__image only-light pst-js-only" alt="nnsight - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../start.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../documentation.html">
    Documentation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../features.html">
    Features
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../tutorials.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../about.html">
    About
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item"><script>
    fetch("https://ndif.dev/ping")
        .then((response) => {
            if (response.status == 200) {
                Array.from(document.getElementsByClassName("ndif")).forEach((ndifElement) => {
                    Array.from(ndifElement.getElementsByTagName('span')).forEach((spanElement) => {
                        spanElement.style.setProperty('color', '#66800b', 'important');
                    });
                });
            }
            else {
                Array.from(document.getElementsByClassName("ndif")).forEach((ndifElement) => {
                    Array.from(ndifElement.getElementsByTagName('span')).forEach((spanElement) => {
                        spanElement.style.setProperty('color', '#af3029', 'important');
                    });
                });
                var statusIcon = document.querySelector('.ndif .fa-circle-check');
                if (statusIcon) {
                    // not here
                    statusIcon.classList.replace('fa-circle-check', 'fa-circle-xmark'); 
                }
            }
        })
        .catch((response) => {
            Array.from(document.getElementsByClassName("ndif")).forEach((ndifElement) => {
                Array.from(ndifElement.getElementsByTagName('span')).forEach((spanElement) => {
                    spanElement.style.setProperty('color', '#af3029', 'important');
                });
            });
            var statusIcon = document.querySelector('.ndif .fa-circle-check');
            if (statusIcon) {
                statusIcon.classList.replace('fa-circle-check', 'fa-circle-xmark');
            }
        })
</script></div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="/status" title="Status: Unknown" class="ndif" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-circle-check fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Status: Unknown</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ndif-team/nnsight" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discuss.ndif.us/" title="Forum" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discourse fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Forum</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://forms.gle/1Y6myaXYzSh3oHf56" title="Discord" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discord fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discord</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../start.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../documentation.html">
    Documentation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../features.html">
    Features
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../tutorials.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../about.html">
    About
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><script>
    fetch("https://ndif.dev/ping")
        .then((response) => {
            if (response.status == 200) {
                Array.from(document.getElementsByClassName("ndif")).forEach((ndifElement) => {
                    Array.from(ndifElement.getElementsByTagName('span')).forEach((spanElement) => {
                        spanElement.style.setProperty('color', '#66800b', 'important');
                    });
                });
            }
            else {
                Array.from(document.getElementsByClassName("ndif")).forEach((ndifElement) => {
                    Array.from(ndifElement.getElementsByTagName('span')).forEach((spanElement) => {
                        spanElement.style.setProperty('color', '#af3029', 'important');
                    });
                });
                var statusIcon = document.querySelector('.ndif .fa-circle-check');
                if (statusIcon) {
                    // not here
                    statusIcon.classList.replace('fa-circle-check', 'fa-circle-xmark'); 
                }
            }
        })
        .catch((response) => {
            Array.from(document.getElementsByClassName("ndif")).forEach((ndifElement) => {
                Array.from(ndifElement.getElementsByTagName('span')).forEach((spanElement) => {
                    spanElement.style.setProperty('color', '#af3029', 'important');
                });
            });
            var statusIcon = document.querySelector('.ndif .fa-circle-check');
            if (statusIcon) {
                statusIcon.classList.replace('fa-circle-check', 'fa-circle-xmark');
            }
        })
</script></div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="/status" title="Status: Unknown" class="ndif" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-circle-check fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Status: Unknown</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ndif-team/nnsight" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discuss.ndif.us/" title="Forum" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discourse fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Forum</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://forms.gle/1Y6myaXYzSh3oHf56" title="Discord" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discord fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discord</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../walkthroughs.html">Main Tutorials</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/get_started/walkthrough.html">Walkthrough</a></li>




<li class="toctree-l2"><a class="reference internal" href="../tutorials/get_started/start_remote_access.html">Access LLMs with NDIF and NNsight</a></li>






<li class="toctree-l2"><a class="reference internal" href="../tutorials/get_started/chat_templates.html">Chat Templates</a></li>





<li class="toctree-l2"><a class="reference internal" href="../tutorials/probing/logit_lens.html">Logit Lens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/probing/diffusion_lens.html">Diffusion Lens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/steering/dict_learning.html">Dictionary Learning</a></li>


<li class="toctree-l2"><a class="reference internal" href="../tutorials/steering/LoRA_tutorial.html">LoRA for Sentiment Analysis</a></li>




<li class="toctree-l2"><a class="reference internal" href="../tutorials/causal_mediation_analysis/activation_patching.html">Activation Patching</a></li>




<li class="toctree-l2"><a class="reference internal" href="../tutorials/causal_mediation_analysis/attribution_patching.html">Attribution Patching</a></li>

<li class="toctree-l2"><a class="reference internal" href="../tutorials/causal_mediation_analysis/DAS.html">DAS</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../applied_tutorials.html">Mini Papers</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="csordas_llm_depth.html">Do Language Models Use Their Depth Efficiently?</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">The Geometry of Truth</a></li>
<li class="toctree-l2"><a class="reference internal" href="todd_function_vectors.html">Function Vectors</a></li>






</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../tutorials.html" class="nav-link">Tutorials</a></li>
    
    
    <li class="breadcrumb-item"><a href="../../applied_tutorials.html" class="nav-link">Mini Paper Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">The Geometry of Truth</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="The-Geometry-of-Truth">
<h1>The Geometry of Truth<a class="headerlink" href="#The-Geometry-of-Truth" title="Link to this heading">#</a></h1>
<p>Emergent Linear Structure in Large Language Model Representations of True/False Datasets</p>
<p>Modern LMs seem to be able to reason about true and false statements. Yet how do they represent factuality in their internal representations?</p>
<p>In this tutorial, we’ll follow <a class="reference external" href="https://arxiv.org/abs/2310.06824">Marks and Tegmark (2023) The Geometry of Truth</a>, which finds linear structure in representations of true and false statements!</p>
<p>Specifically, we will investigate:</p>
<ul class="simple">
<li><p><strong>Information flow</strong>: where does an LM store information about the truth of a sentence?</p></li>
<li><p><strong>Visualizing activations</strong>: using PCA to visualize low dimensions of LM internals.</p></li>
<li><p><strong>Difference in means</strong> and why linear probing might not always be the right choice!</p></li>
<li><p><strong>Steering LMs</strong> both small and large!</p></li>
</ul>
<p>If you’re reading along, our tutorial will roughly recreate Figures 1 and 2, and then give an in-depth explanation of Figure 4 from the paper.</p>
<section id="0️⃣-Setup">
<h2>0️⃣ Setup<a class="headerlink" href="#0️⃣-Setup" title="Link to this heading">#</a></h2>
<p>Run this code before we begin!</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># install the latest version of nnsight</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">clear_output</span>

<span class="k">try</span><span class="p">:</span>
  <span class="kn">import</span><span class="w"> </span><span class="nn">google.colab</span>
  <span class="n">is_colab</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
  <span class="n">is_colab</span> <span class="o">=</span> <span class="kc">False</span>

<span class="k">if</span> <span class="n">is_colab</span><span class="p">:</span>
  <span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">nnsight</span><span class="o">==</span><span class="mf">0.5.0</span><span class="o">.</span><span class="n">dev</span>

<span class="n">clear_output</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p><strong>Note</strong></p>
<p>In this tutorial, we use the Llama-3.2 3B model. Before starting the tutorial, please go to the model’s <a class="reference external" href="https://huggingface.co/meta-llama/Llama-3.2-3B">huggingface page</a> and request permission to use the model. Then, log in to this notebook with your <a class="reference external" href="https://huggingface.co/docs/hub/en/security-tokens">huggingface access token</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">huggingface_hub</span><span class="w"> </span><span class="kn">import</span> <span class="n">notebook_login</span>

<span class="n">notebook_login</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "f9a61498d0174eaf8f50a64726760f8d"}</script></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># (try to) set seeds for reproducibility</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># util functions for tutorial</span>
<span class="k">class</span><span class="w"> </span><span class="nc">COLORS</span><span class="p">:</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;keep consistent plotting colors&quot;&quot;&quot;</span>
  <span class="n">LIGHT_BLUE</span> <span class="o">=</span> <span class="s2">&quot;#46B1E1&quot;</span>
  <span class="n">BLUE</span> <span class="o">=</span> <span class="s2">&quot;#156082&quot;</span>
  <span class="n">LIGHT_ORANGE</span> <span class="o">=</span> <span class="s2">&quot;#F2AA84&quot;</span>
  <span class="n">ORANGE</span> <span class="o">=</span> <span class="s2">&quot;#E97132&quot;</span>
  <span class="n">PURPLE</span> <span class="o">=</span> <span class="s2">&quot;#A02B93&quot;</span>
  <span class="n">GREEN</span> <span class="o">=</span> <span class="s2">&quot;#4EA72E&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">hex_to_rgba</span><span class="p">(</span><span class="n">hex_color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;convert hex to rgb with opacity parameter&quot;&quot;&quot;</span>
  <span class="n">hex_color</span> <span class="o">=</span> <span class="n">hex_color</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>
  <span class="n">rgb</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hex_color</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
  <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;rgba(</span><span class="si">{</span><span class="n">rgb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">rgb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">rgb</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s1">)&#39;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">rindex</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;get the rightmost index of a value in a list.&quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">lst</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="1️⃣-Information-flow">
<h2>1️⃣ Information flow<a class="headerlink" href="#1️⃣-Information-flow" title="Link to this heading">#</a></h2>
<p>LMs seem to be able to classify true and false statements in-context. Yet where is this information stored? In this section, we’ll see how <strong>activation patching</strong> can inform which token and layer activations play a <strong>causal role</strong> in representing the truth of a sentence.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># load model</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">nnsight</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">clear_output</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">nnsight</span><span class="o">.</span><span class="n">LanguageModel</span><span class="p">(</span><span class="s2">&quot;meta-llama/Llama-3.2-3B&quot;</span><span class="p">,</span> <span class="n">device_map</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
<span class="n">clear_output</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s set up a few-shot prompt to see if models can reason about factuality</span>
<span class="n">PROMPT_TEMPLATE</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;The city of Tokyo is in Japan. This statement is: TRUE</span>
<span class="s2">The city of Hanoi is in Poland. This statement is: FALSE</span>
<span class="si">{statement}</span><span class="s2"> This statement is:&quot;&quot;&quot;</span>

<span class="n">source_statement</span> <span class="o">=</span> <span class="s2">&quot;The city of Toronto is in Canada.&quot;</span> <span class="c1"># true</span>
<span class="n">source_prompt</span> <span class="o">=</span> <span class="n">PROMPT_TEMPLATE</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">statement</span><span class="o">=</span><span class="n">source_statement</span><span class="p">)</span>
<span class="n">base_statement</span> <span class="o">=</span> <span class="s2">&quot;The city of Chicago is in Canada.&quot;</span> <span class="c1"># false</span>
<span class="n">base_prompt</span> <span class="o">=</span> <span class="n">PROMPT_TEMPLATE</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">statement</span><span class="o">=</span><span class="n">base_statement</span><span class="p">)</span>

<span class="c1"># this is a false statement</span>
<span class="nb">print</span><span class="p">(</span><span class="n">base_prompt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The city of Tokyo is in Japan. This statement is: TRUE
The city of Hanoi is in Poland. This statement is: FALSE
The city of Chicago is in Canada. This statement is:
</pre></div></div>
</div>
<p>Let’s put our model to the test - can it identify true and false statements? We’ll use a single example where we only vary the city: “the city of Toronto is in Canada” (true) vs. “the city of Chicago is in Canada” (false).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># does the model know that Chicago isn&#39;t in Canada?</span>
<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">base_prompt</span><span class="p">)</span> <span class="k">as</span> <span class="n">trace</span><span class="p">:</span>
    <span class="c1"># save the model&#39;s output logits</span>
    <span class="n">logits</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">logits</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="c1"># what&#39;s the model&#39;s response?</span>
<span class="nb">print</span><span class="p">(</span><span class="n">base_prompt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">logits</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "4f9d39efeeb04aff8a10d227dea3542c"}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The city of Chicago is in Canada. This statement is:
 FALSE
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># does the model know that Toronto is in Canada?</span>
<span class="n">source_activations</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">source_prompt</span><span class="p">)</span> <span class="k">as</span> <span class="n">trace</span><span class="p">:</span>
    <span class="c1"># let&#39;s save the intemediate activations - we&#39;ll use them in the next step!</span>
    <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
      <span class="n">source_activations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">())</span>
    <span class="c1"># save the model&#39;s output logits</span>
    <span class="n">logits</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">logits</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">source_prompt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">logits</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The city of Toronto is in Canada. This statement is:
 TRUE
</pre></div></div>
</div>
<section id="Activation-Patching">
<h3>Activation Patching<a class="headerlink" href="#Activation-Patching" title="Link to this heading">#</a></h3>
<p>Okay, so our model seems to know a true statement from a false one. Where did it store this information? Let’s use <strong>activation patching</strong> between our two examples to see which token and layer activations <strong>causally mediated</strong> the truth of the statement.</p>
<p>If you’re not familiar with activation patching, we <strong>strongly encourage you to check out the activation patching tutorial on ``nnsight``!</strong> We’ll leave some comments to explain the process.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># run activation patching from source (true) -&gt; base (false)</span>
<span class="c1"># and measure P(TRUE) - P(FALSE)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">trange</span>

<span class="n">true_token_id</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">(</span><span class="s2">&quot; TRUE&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">input_ids</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">false_token_id</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">(</span><span class="s2">&quot; FALSE&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">input_ids</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">source_prompt_ids</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">(</span><span class="n">source_prompt</span><span class="p">)</span><span class="o">.</span><span class="n">input_ids</span>
<span class="n">newline_token_id</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">input_ids</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">last_example_index</span> <span class="o">=</span> <span class="n">rindex</span><span class="p">(</span><span class="n">source_prompt_ids</span><span class="p">,</span> <span class="n">newline_token_id</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># get start of final example</span>

<span class="n">patching_results</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># save interchange intervention accuracies</span>
<span class="k">for</span> <span class="n">layer_index</span> <span class="ow">in</span> <span class="n">trange</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">num_hidden_layers</span><span class="p">):</span> <span class="c1"># loop through layers</span>
  <span class="n">patching_per_layer</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">token_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">last_example_index</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">source_prompt_ids</span><span class="p">)):</span> <span class="c1"># loop through story tokens</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
      <span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">base_prompt</span><span class="p">):</span>
        <span class="c1"># patch source -&gt; base</span>
        <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">layer_index</span><span class="p">]</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="n">token_index</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">source_activations</span><span class="p">[</span><span class="n">layer_index</span><span class="p">][:,</span> <span class="n">token_index</span><span class="p">,</span> <span class="p">:]</span>
        <span class="c1"># get model output</span>
        <span class="n">patched_probs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">logits</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># convert logits to probs with softmax</span>
        <span class="c1"># get probability of generating true vs. false answer</span>
        <span class="n">patched_true_prob</span> <span class="o">=</span> <span class="n">patched_probs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">true_token_id</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="n">patched_false_prob</span> <span class="o">=</span> <span class="n">patched_probs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">false_token_id</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="c1"># save difference btw true &amp; false answers</span>
        <span class="n">patched_diff</span> <span class="o">=</span> <span class="n">patched_true_prob</span> <span class="o">-</span> <span class="n">patched_false_prob</span>
        <span class="n">patching_per_layer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">patched_diff</span><span class="o">.</span><span class="n">save</span><span class="p">())</span>
  <span class="n">patching_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">patching_per_layer</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 28/28 [00:57&lt;00:00,  2.04s/it]
</pre></div></div>
</div>
<p>Let’s plot our results! The darker the color, the <strong>more effect</strong> the residual activation at that token/layer position has.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot results</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">plotly.express</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">px</span>

<span class="c1"># convert token indices to token strings</span>
<span class="n">base_token_ids</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">(</span><span class="n">base_prompt</span><span class="p">)</span><span class="o">.</span><span class="n">input_ids</span>
<span class="n">token_strings</span> <span class="o">=</span> <span class="p">[</span>
  <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">base_token_ids</span><span class="p">[</span><span class="n">t</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">i</span>
  <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">last_example_index</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">base_token_ids</span><span class="p">)))</span>
<span class="p">]</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
  <span class="n">patching_results</span><span class="p">,</span>
  <span class="n">y</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">num_hidden_layers</span><span class="p">)),</span>
  <span class="n">template</span><span class="o">=</span><span class="s1">&#39;simple_white&#39;</span><span class="p">,</span>
  <span class="n">color_continuous_scale</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;#FFFFFF&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">COLORS</span><span class="o">.</span><span class="n">BLUE</span><span class="p">]],</span>
  <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
  <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">ticktext</span><span class="o">=</span><span class="n">token_strings</span><span class="p">,</span> <span class="n">tickvals</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">token_strings</span><span class="p">)))),</span>
  <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;tokens&#39;</span><span class="p">,</span>
  <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">autorange</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">),</span>
  <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;layers&#39;</span>
<span class="p">)</span>

<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="7a0badb2-6aa0-450c-ac1c-eeb1646a107b" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("7a0badb2-6aa0-450c-ac1c-eeb1646a107b")) {                    Plotly.newPlot(                        "7a0badb2-6aa0-450c-ac1c-eeb1646a107b",                        [{"coloraxis":"coloraxis","name":"0","y":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27],"z":[[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,0.7395643293857574,-0.3386479914188385,-0.33820605278015137,-0.33812910318374634,-0.33913129568099976,-0.3379921615123749,-0.3391379415988922,-0.33854806423187256,-0.33880743384361267],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,0.7398373782634735,-0.3407021164894104,-0.3375219404697418,-0.33388152718544006,-0.337868869304657,-0.33861833810806274,-0.33909177780151367,-0.3390032947063446,-0.33849766850471497],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,0.7372656911611557,-0.3390408754348755,-0.33632904291152954,-0.32956379652023315,-0.3375033140182495,-0.3375402092933655,-0.3388536870479584,-0.33939361572265625,-0.3377992808818817],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,0.6578120589256287,-0.34574708342552185,-0.33539390563964844,-0.04642435908317566,-0.3342929482460022,-0.3383476734161377,-0.3391224443912506,-0.33900612592697144,-0.3369406461715698],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,0.6564184129238129,-0.34446993470191956,-0.33857303857803345,-0.021283656358718872,-0.33232396841049194,-0.33901897072792053,-0.3378646671772003,-0.3384160101413727,-0.34104758501052856],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,0.6087125241756439,-0.3439421057701111,-0.3393104076385498,0.15827122330665588,-0.3331014811992645,-0.33982735872268677,-0.33751487731933594,-0.33836832642555237,-0.33938077092170715],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,0.5858015418052673,-0.34303778409957886,-0.338164746761322,0.3688005805015564,-0.33093467354774475,-0.33980879187583923,-0.33926716446876526,-0.3395955264568329,-0.3269970417022705],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,0.22678783535957336,-0.33704283833503723,-0.3384276330471039,0.6101809442043304,-0.32862693071365356,-0.34031015634536743,-0.33772826194763184,-0.3412877321243286,-0.324876070022583],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.33559900522232056,-0.32870718836784363,-0.3374742269515991,0.6303595900535583,-0.32522839307785034,-0.3406144678592682,-0.33923447132110596,-0.34007909893989563,-0.33089402318000793],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.33205321431159973,-0.32488980889320374,-0.34189990162849426,0.5974404066801071,-0.30993133783340454,-0.3411667048931122,-0.339837908744812,-0.33947885036468506,-0.3487396538257599],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.3712608218193054,-0.3261759877204895,-0.3380286395549774,0.5650000274181366,-0.31569704413414,-0.3410840630531311,-0.3369792401790619,-0.3367108404636383,-0.36828574538230896],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.3459794819355011,-0.34255868196487427,-0.3412993848323822,0.04356369376182556,-0.32734689116477966,-0.34732964634895325,-0.3321689963340759,-0.33604496717453003,-0.31137773394584656],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.35128793120384216,-0.3406253159046173,-0.33981800079345703,-0.17829182744026184,-0.2506551146507263,-0.34130439162254333,-0.33726802468299866,-0.3291915953159332,0.046193599700927734],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.35118114948272705,-0.3381770849227905,-0.33744242787361145,-0.17444610595703125,-0.2508994936943054,-0.3393647372722626,-0.31923365592956543,-0.3037547171115875,0.301693856716156],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.3481101989746094,-0.3393184244632721,-0.3386155664920807,-0.32832008600234985,-0.32242169976234436,-0.3382948338985443,-0.32405027747154236,-0.2694488763809204,0.6084273606538773],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.34470218420028687,-0.338847279548645,-0.3404247462749481,-0.3322139382362366,-0.3308499753475189,-0.3373984098434448,-0.32312244176864624,-0.2739136815071106,0.6419123411178589],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.34340381622314453,-0.33849889039993286,-0.3401073217391968,-0.3341544270515442,-0.33200210332870483,-0.3388001024723053,-0.33046653866767883,-0.27474507689476013,0.6591541767120361],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.34314632415771484,-0.3387776017189026,-0.3405226767063141,-0.33518272638320923,-0.3327167332172394,-0.3385258913040161,-0.33148685097694397,-0.27602246403694153,0.6665093153715134],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.3432742655277252,-0.3387434482574463,-0.34029677510261536,-0.33509528636932373,-0.3336668312549591,-0.3381156623363495,-0.33285388350486755,-0.2852354347705841,0.6821970492601395],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.34417328238487244,-0.3385879099369049,-0.3402988612651825,-0.33578911423683167,-0.3375242352485657,-0.33855077624320984,-0.3374491333961487,-0.2930196225643158,0.6996046155691147],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.3438212275505066,-0.33863508701324463,-0.34048545360565186,-0.3366899788379669,-0.33753177523612976,-0.33841240406036377,-0.33783259987831116,-0.2936573922634125,0.7002053707838058],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.3414677679538727,-0.3386525511741638,-0.3409274220466614,-0.3373747766017914,-0.3377945125102997,-0.3384280204772949,-0.337991327047348,-0.29407525062561035,0.699172705411911],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.34173718094825745,-0.338456928730011,-0.34080740809440613,-0.33777111768722534,-0.3371443748474121,-0.33787989616394043,-0.33544835448265076,-0.29701104760169983,0.7088167667388916],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.34173867106437683,-0.3382907509803772,-0.34063807129859924,-0.33788859844207764,-0.3373658061027527,-0.33827370405197144,-0.3369593620300293,-0.3116505444049835,0.7188717722892761],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.3415125608444214,-0.3384128510951996,-0.34038087725639343,-0.3377850651741028,-0.33746853470802307,-0.3382750153541565,-0.33715182542800903,-0.3117091655731201,0.7193354666233063],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.3416968584060669,-0.3385232090950012,-0.3385823965072632,-0.3391278386116028,-0.3377029299736023,-0.3385825455188751,-0.337567001581192,-0.31457284092903137,0.7215553969144821],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.34168097376823425,-0.3385154902935028,-0.3386093080043793,-0.33790987730026245,-0.33769962191581726,-0.33823680877685547,-0.33790135383605957,-0.3163580894470215,0.724319115281105],[-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,-0.3384948968887329,0.7397956401109695]],"type":"heatmap","xaxis":"x","yaxis":"y","hovertemplate":"x: %{x}\u003cbr\u003ey: %{y}\u003cbr\u003ecolor: %{z}\u003cextra\u003e\u003c\u002fextra\u003e"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"ticktext":["The"," city "," of  "," Chicago   "," is    "," in     "," Canada      ",".       "," This        "," statement         "," is          ",":           "],"tickvals":[0,1,2,3,4,5,6,7,8,9,10,11]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"autorange":"min"},"coloraxis":{"colorscale":[[0,"#FFFFFF"],[1,"#156082"]]},"margin":{"t":60}},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('7a0badb2-6aa0-450c-ac1c-eeb1646a107b');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div>
</div>
<p>We read this plot starting from the bottom, starting at the “Toronto -&gt; “Chicago” token. We can trace <strong>how the information flows from the input to the output</strong>!</p>
<p>Let’s jot down some takeaways.</p>
<ol class="arabic simple">
<li><p><strong>The input</strong>: in the early layers, the “Toronto -&gt; Chicago” token accounts for the difference between outputting TRUE vs. FALSE. This makes sense, because it’s the only thing we changed in the input!</p></li>
<li><p><strong>The output</strong>: in the last layers, the information is stored at the last token. This also makes sense, because LMs are autoregressive, meaning they can only refer to the final token when generating the next one.</p></li>
<li><p><strong>Something interesting in the middle…</strong> looks like the city token and the final token aren’t the only ones carrying meaningful information about the factuality of the sentence! The <strong>final sentence token and the end-of-sentence punctuation (“.”) mediate truth</strong> as well!</p></li>
</ol>
<p>In the original paper, the authors investigated the representation under the end-of-sentence punctuation (“.”). However, we’ll differ slightly and analyze the representation over the final token in the sentence (e.g., “Canda”). <strong>From now on, our analysis will only focus on the representation of the final token in the sentence at the 10th layer</strong>, because it seems to mediate factuality!</p>
</section>
</section>
<section id="2️⃣-Visualizing-activations">
<h2>2️⃣ Visualizing activations<a class="headerlink" href="#2️⃣-Visualizing-activations" title="Link to this heading">#</a></h2>
<p>Now that we’ve identified <strong>where</strong> an LM represents the truth of a statement, let’s investigate <strong>how</strong> it represents this information. To start, we’ll visualize the representations of true and false statements, projecting them to a lower dimension using PCA.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s load set of 50 true and 50 negative statements</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/saprmarks/geometry-of-truth/refs/heads/main/datasets/cities.csv&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
  <div id="df-e39d423e-c170-413d-a9d6-defd6fe4f441" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>statement</th>
      <th>label</th>
      <th>city</th>
      <th>country</th>
      <th>correct_country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>The city of Krasnodar is in Russia.</td>
      <td>1</td>
      <td>Krasnodar</td>
      <td>Russia</td>
      <td>Russia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The city of Krasnodar is in South Africa.</td>
      <td>0</td>
      <td>Krasnodar</td>
      <td>South Africa</td>
      <td>Russia</td>
    </tr>
    <tr>
      <th>2</th>
      <td>The city of Lodz is in Poland.</td>
      <td>1</td>
      <td>Lodz</td>
      <td>Poland</td>
      <td>Poland</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The city of Lodz is in the Dominican Republic.</td>
      <td>0</td>
      <td>Lodz</td>
      <td>the Dominican Republic</td>
      <td>Poland</td>
    </tr>
    <tr>
      <th>4</th>
      <td>The city of Maracay is in Venezuela.</td>
      <td>1</td>
      <td>Maracay</td>
      <td>Venezuela</td>
      <td>Venezuela</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e39d423e-c170-413d-a9d6-defd6fe4f441')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e39d423e-c170-413d-a9d6-defd6fe4f441 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e39d423e-c170-413d-a9d6-defd6fe4f441');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-fa79fbcf-1b5e-49c9-801e-e0e356f348a7">
      <button class="colab-df-quickchart" onclick="quickchart('df-fa79fbcf-1b5e-49c9-801e-e0e356f348a7')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-fa79fbcf-1b5e-49c9-801e-e0e356f348a7 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s collect the model&#39;s activations over each statement at the same location</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">trange</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="c1"># we&#39;ll focus on the 10th layer and the last token before the &quot;.&quot;</span>
<span class="n">LAYER</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">punctuation_token_id</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">input_ids</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">true_activations</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">false_activations</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">trange</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="c1"># loop through dataset</span>
  <span class="n">row</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
  <span class="n">prompt</span> <span class="o">=</span> <span class="n">PROMPT_TEMPLATE</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">statement</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="n">statement</span><span class="p">)</span>
  <span class="n">prompt_token_ids</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span><span class="o">.</span><span class="n">input_ids</span>
  <span class="c1"># get index of final token in the sentence (before the &quot;.&quot;)</span>
  <span class="n">final_token_index</span> <span class="o">=</span> <span class="n">rindex</span><span class="p">(</span><span class="n">prompt_token_ids</span><span class="p">,</span> <span class="n">punctuation_token_id</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

  <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span> <span class="k">as</span> <span class="n">trace</span><span class="p">:</span>
      <span class="c1"># get the model&#39;s activation at our chosen token &amp; layer position</span>
      <span class="n">activation</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">LAYER</span><span class="p">]</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="n">final_token_index</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">save</span><span class="p">()</span> <span class="c1"># (1, hidden_dim)</span>
      <span class="c1"># add to our false/true activations!</span>
      <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">false_activations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">activation</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">true_activations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">activation</span><span class="p">)</span>

<span class="n">true_activations</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">true_activations</span><span class="p">)</span> <span class="c1"># (50, hidden_dim)</span>
<span class="n">false_activations</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">false_activations</span><span class="p">)</span> <span class="c1"># (50, hidden_dim)</span>
</pre></div>
</div>
</div>
<p>It’s hard to visualize an 8,192 dimensional vector! So let’s try to only visualize two dimensions. We can do this with PCA, which will pick out the <code class="docutils literal notranslate"><span class="pre">n</span></code> dimensions that best explain the variance across our collected activations.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># go from 8192 -&gt; 2 dimensions with PCA!</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>

<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">all_activations</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">true_activations</span><span class="p">,</span> <span class="n">false_activations</span><span class="p">])</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span> <span class="c1"># (100, hidden_dim)</span>

<span class="n">low_dim_activations</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">all_activations</span><span class="p">)</span> <span class="c1"># (100, 2)</span>
<span class="n">low_dim_activations</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(100, 2)
</pre></div></div>
</div>
<p>Let’s visualize our results! We’ll color the model representation of each sentence by whether that sentence is true or false.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">plotly.graph_objects</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">go</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
  <span class="n">x</span><span class="o">=</span><span class="n">low_dim_activations</span><span class="p">[:</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
  <span class="n">y</span><span class="o">=</span><span class="n">low_dim_activations</span><span class="p">[:</span><span class="mi">50</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
  <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
  <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">hex_to_rgba</span><span class="p">(</span><span class="n">COLORS</span><span class="o">.</span><span class="n">LIGHT_BLUE</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
<span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
  <span class="n">x</span><span class="o">=</span><span class="n">low_dim_activations</span><span class="p">[</span><span class="mi">50</span><span class="p">:,</span> <span class="mi">0</span><span class="p">],</span>
  <span class="n">y</span><span class="o">=</span><span class="n">low_dim_activations</span><span class="p">[</span><span class="mi">50</span><span class="p">:,</span> <span class="mi">1</span><span class="p">],</span>
  <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
  <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">hex_to_rgba</span><span class="p">(</span><span class="n">COLORS</span><span class="o">.</span><span class="n">LIGHT_ORANGE</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
<span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
  <span class="n">template</span><span class="o">=</span><span class="s1">&#39;simple_white&#39;</span><span class="p">,</span>
  <span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
  <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
  <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;PCA 1&#39;</span><span class="p">,</span>
  <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;PCA 2&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="17696985-d175-4d6d-9f70-91f601b0c7b3" class="plotly-graph-div" style="height:400px; width:400px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("17696985-d175-4d6d-9f70-91f601b0c7b3")) {                    Plotly.newPlot(                        "17696985-d175-4d6d-9f70-91f601b0c7b3",                        [{"marker":{"color":"rgba(70, 177, 225, 0.5)","size":10,"symbol":"square"},"mode":"markers","name":"true","x":[-2.4357777,-2.3659742,-2.428082,-2.8614545,-2.9733396,-3.1095293,-2.561726,-2.724231,-3.0946765,-2.7965415,-2.9245622,-2.3552501,-3.007053,-3.1798494,-2.6872003,-2.7317977,-2.8631096,-1.8522726,-2.758043,-2.7868223,-3.6232467,-3.3061368,-2.9869277,-3.5585947,-3.2628887,-3.3237188,-3.0670424,-2.3259993,-2.9281306,-2.776778,-3.5873418,-3.5580885,-3.2243638,-2.7772026,-3.593178,-2.643526,-3.2269366,-2.6844954,-3.1741521,-2.7332933,-3.2954519,-2.7786248,-2.8108585,-3.052274,-3.1005626,-2.642212,-2.3491645,-2.202498,-3.0739667,-2.6005585],"y":[0.31575033,1.384186,2.9140794,2.4482524,-2.608425,2.3402658,2.6705198,-2.5350513,-2.3601098,-2.569144,-2.306179,-2.4874163,-2.3006232,-2.3408077,-2.5931044,2.780016,2.1108603,0.12498245,2.307936,0.14557652,-0.30878007,-0.40048277,-0.6007552,-0.6169583,-0.28718182,-0.4174849,0.7218509,-0.7799002,2.6509697,1.3314295,-0.2764541,-0.2035457,-0.4142934,-0.74749583,-0.2005157,-2.6177633,-2.3585355,-2.4585712,-2.205611,-2.5900242,-2.2647898,2.5926425,3.2867353,2.3881154,2.5221858,0.67478395,2.0904436,-0.09708741,2.3459947,2.7286954],"type":"scatter"},{"marker":{"color":"rgba(242, 170, 132, 0.5)","size":10,"symbol":"circle"},"mode":"markers","name":"false","x":[3.378128,4.283626,3.8221078,1.6287973,3.0091066,2.6192908,3.9941168,2.9171362,2.3680775,2.7933655,3.423819,3.6307716,3.454274,1.6921823,-0.1371135,3.0947783,2.4293363,3.0284464,1.1890168,3.236538,3.6493208,3.2366443,-1.4279865,3.1062582,4.969109,2.3376086,3.0601764,4.7382455,3.0680335,1.5798181,3.443404,3.462861,2.257416,4.133473,3.8769886,2.949747,3.337973,3.6895876,2.6240697,3.9343026,2.3499713,1.6576295,3.6432076,4.7996416,2.7161818,2.6834524,3.5199645,4.159522,-0.051330775,1.4044096],"y":[1.2623643,1.7610922,-2.7136426,1.0653287,2.0886145,-0.041640747,-2.8821619,1.113719,1.738396,0.3608757,1.1736857,1.1660542,0.5753437,0.8075206,-1.3632394,1.424406,-0.058305733,0.8802689,-0.9840082,1.445907,1.5526842,1.0516812,0.5158176,-2.781143,-0.43786573,-0.24926604,0.74499404,1.7529166,0.32782462,-0.93007267,-2.7704554,-2.6642463,-0.3783016,0.48261818,1.0061266,0.97833705,-0.9534326,1.6369076,1.9231422,-0.9400094,0.18851076,-0.18972187,-2.8472047,-0.48431367,-2.5822406,-0.9071939,-2.5595088,-0.26459852,0.042919666,-0.014663159],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"width":400,"height":400,"xaxis":{"title":{"text":"PCA 1"}},"yaxis":{"title":{"text":"PCA 2"}}},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('17696985-d175-4d6d-9f70-91f601b0c7b3');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div>
</div>
<p>Behold! The model representations form two clusters that correspond to the factuality of their input sentences. This means that the <strong>representations of truth in our dataset are linearly separable</strong> - a linear classifier over the model’s internals should be able to tell us with high accuracy whether the representations came from a true or false statement.</p>
<p><strong>HOWEVER</strong>, just because the representations are linearly separable, it <strong>doesn’t mean the LM represents the concept linearly!</strong> To see why, we’ll go on a short but important tangent, exploring the difference between <strong>prediction vs. control</strong>.</p>
</section>
<section id="3️⃣-Choosing-the-right-probe---linear-classifiers-vs.-difference-in-means">
<h2>3️⃣ Choosing the right probe - linear classifiers vs. difference in means<a class="headerlink" href="#3️⃣-Choosing-the-right-probe---linear-classifiers-vs.-difference-in-means" title="Link to this heading">#</a></h2>
<p>As we just saw, even in a low-dimension space, it’s easy to tell activations over true statements and activations over false statements apart! But what’s driving the difference between true and false activations?</p>
<p>Different <strong>linear probes</strong> can give us directions in the latent space of the LLM that separate true and false activations. But we should be careful, because <strong>probes are likely to pick up on correlations instead of causal directions!</strong></p>
<p>To understand why this might happen, let’s consider an example story.</p>
<p><img alt="visualizing logistic regression vs. difference in means" src="https://github.com/AmirZur/nnsight-tutorials/blob/main/figures/steering%20visualization.gif?raw=true" /></p>
<p>Imagine that Prof. X wants to improve the outcomes of his gifted students. Prof. X keeps track of how many assignments a student turned in and their average grade on those assignments, and wants to use this information to predict whether the student passed the final.</p>
<p>But <strong>predicting</strong> is not enough. Prof. X wants to use the information from his predictor to <strong>improve</strong> his students’ performance on the final next year. Can his predictor give Prof. X useful information about the <strong>intervention</strong> he should design to improve student performance?</p>
<p><strong>Note before we run any code</strong></p>
<p>In this section, we won’t need a GPU! Feel free to change your runtime to CPU and re-run the code in the Setup section to save on compute.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># create fake dataset of students</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">low_group_effort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.8</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
<span class="n">high_group_effort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.8</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>

<span class="n">low_group_grade</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">low_group_effort</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
<span class="n">high_group_grade</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">high_group_effort</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span>
    <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">low_group_effort</span><span class="p">,</span> <span class="n">high_group_effort</span><span class="p">)),</span> <span class="c1"># x-axis</span>
    <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">low_group_grade</span><span class="p">,</span> <span class="n">high_group_grade</span><span class="p">))</span> <span class="c1"># y-axis</span>
<span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="n">X</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># center</span>

<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">plotly.graph_objects</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">go</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="n">mean_low</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:</span><span class="n">N</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mean_high</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">N</span><span class="p">:]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_traces</span><span class="p">([</span>
  <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">[:</span><span class="n">N</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">X</span><span class="p">[:</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">hex_to_rgba</span><span class="p">(</span><span class="n">COLORS</span><span class="o">.</span><span class="n">LIGHT_BLUE</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;failed final&#39;</span><span class="p">,</span>
  <span class="p">),</span>
  <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">[</span><span class="n">N</span><span class="p">:,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">X</span><span class="p">[</span><span class="n">N</span><span class="p">:,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">hex_to_rgba</span><span class="p">(</span><span class="n">COLORS</span><span class="o">.</span><span class="n">LIGHT_ORANGE</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;passed final&#39;</span><span class="p">,</span>
  <span class="p">),</span>
  <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">mean_low</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
    <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">mean_low</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">hex_to_rgba</span><span class="p">(</span><span class="n">COLORS</span><span class="o">.</span><span class="n">BLUE</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
    <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
  <span class="p">),</span>
  <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">mean_high</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
    <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">mean_high</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">hex_to_rgba</span><span class="p">(</span><span class="n">COLORS</span><span class="o">.</span><span class="n">ORANGE</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
    <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span>
  <span class="p">)</span>
<span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
  <span class="n">template</span><span class="o">=</span><span class="s1">&#39;simple_white&#39;</span><span class="p">,</span>
  <span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
  <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
  <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;# of assignments turned in&#39;</span><span class="p">,</span>
  <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;average grade&#39;</span><span class="p">,</span>
  <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">scaleanchor</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">scaleratio</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="c1"># Anchor x-axis to y-axis with 1:1 ratio</span>
  <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">scaleanchor</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">scaleratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Anchor y-axis to x-axis with 1:1 ratio</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="fc424357-08ba-4571-aadf-ea5b2c9066fc" class="plotly-graph-div" style="height:400px; width:500px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("fc424357-08ba-4571-aadf-ea5b2c9066fc")) {                    Plotly.newPlot(                        "fc424357-08ba-4571-aadf-ea5b2c9066fc",                        [{"marker":{"color":"rgba(70, 177, 225, 0.5)","size":10,"symbol":"circle"},"mode":"markers","name":"failed final","x":[-1.324129517162433,-3.4020705968353964,-1.739112919801535,-5.2368281551133915,-0.8198469127358345,-4.938002426218874,-2.1662752732063044,-2.3919138201255397,-3.6280713952757075,2.993770897135655,-3.2515852687758144,-1.3250814254800316,-0.2027830014289842,-4.362807855810381,0.24073745474397246,-2.3953736316473764,-0.352976155285484,-3.8204684779149582,-4.028658387118494,0.002129595492641023,-1.2721338670421352,-1.9255808949631747,-1.0221340098293856,-1.226305216645204,-4.253352437234434,-6.1595042767586765,-5.202665732555625,-5.39407366575628,-6.168866914900917,-3.340879418142472,-3.1266317913102464,-2.2460805285361385,-1.7885473066960431,-2.8673498584407016,-2.6325313544097897,-2.0436502795573004,-3.970470921208813,-3.460445331536479,-2.111754590791528,-3.3958056710652613,-3.2048899247001135,-2.366056181442598,0.22899239576478791,-1.601906495415351,-2.7831754639344606,-3.228986914257728,-2.382359907265953,1.859768016067025,-7.84085375262356,-1.2122594059401859,-1.7570212229536226,-0.6138025022562852,-4.242286899487684,1.6303156207755238,-0.3738070446032866,-2.268051005359405,-1.8878861573123489,-3.4647784692293233,-2.0845629260987293,-2.4335113600325142,-0.47706831090694024,-1.5317444079996543,-2.3257125789284006,-0.9554530285905196,-1.1745953407628242,-1.774608984309908,-4.92767787692107,-0.32292389785658404,-4.27476978086262,-3.992714988001323,-2.3649863935001783,-1.2538641292037047,0.3584059608525809,-5.213357409729115,0.4727171728980073,0.7701292195534393,-3.0060148990384397,-2.5379561001260935,-3.204774128352668,-3.261442420379977,-4.58640461181945,-5.2168792704813,-2.5342932245378362,-1.7115133600072907,1.1163732732903933,-3.9773067948700245,-5.940548197867221,-1.9116965432016553,-3.0149359972169165,-1.5343026006916007,-2.8916875333798453,-4.442106341941019,-3.4154856602460573,-0.7307692033990456,-1.6852001406769972,-3.92002171141843,-0.6059613942788014,-4.778951010877936,-3.141170288886949,-1.8192470844787776],"y":[-1.5084909726111597,-2.885229472594647,-1.631001581692166,-3.8674186057986164,-1.0157654879649325,-3.8393068555221905,-2.4426419012909513,-1.9857959480687004,-2.2790233921274066,0.25930724605371047,-2.153523888640221,-1.2047246772944433,-0.8630998399945362,-3.2452532144986215,-1.5335322455566782,-2.666550356413116,-1.418072174073636,-2.7587687249631827,-3.0710651676784257,-1.196879180392946,-1.6096918979921249,-2.459001050787302,-1.395715947317223,-1.8988375360361234,-2.7444015396622152,-4.033279343994228,-3.829555292496064,-3.8568259575951718,-4.566504945659663,-2.619626073075093,-2.865231779425944,-2.1563430932234464,-1.5509450672538403,-2.3309572140382855,-2.1722943568002613,-1.2287943337206801,-2.776586206740804,-2.395535013811024,-2.1318656088884955,-3.055371239330766,-2.533763872147258,-2.530751179752416,-1.7889614482693847,-1.6214454358410588,-2.2908528444155003,-2.9350209041315782,-1.8030283977456785,-0.09445542501861048,-5.0620970321170455,-1.893927080500207,-1.5309987131544265,-1.4390440850980415,-3.2727196744402267,-0.3260231811852883,-1.42301495964338,-2.640644100642529,-2.1649749741049407,-2.997367694085753,-1.832649093875018,-2.610773611343885,-1.0324505675192714,-1.921450008215868,-2.4070647332231196,-1.529599426123223,-1.5762300635581905,-1.8556060549730606,-3.2897335766438864,-1.0970318819767133,-3.602962219616967,-3.2030350879500755,-1.693793490930915,-1.6618147439415898,-1.5240545586121925,-3.5551845430085978,-0.25233502132285146,-0.2629487648150448,-2.4850890976993627,-2.202296834430358,-2.407397655509487,-2.6768825523533817,-3.438531626232626,-3.1174859700844433,-2.3861972765646113,-1.551631721725455,-0.9137518866562893,-3.223833404975821,-4.315891363331693,-1.8313677039603302,-2.696114700680152,-1.961091839488776,-2.7220444303148037,-3.1767871254237567,-2.413772221647964,-1.5439941531598738,-1.6591533699206398,-2.9642748220717454,-1.48813159585589,-3.2841754033728003,-2.168020752137963,-2.6898054838385015],"type":"scatter"},{"marker":{"color":"rgba(242, 170, 132, 0.5)","size":10,"symbol":"square"},"mode":"markers","name":"passed final","x":[0.3663443210899322,0.6744960970462222,2.8531781629248476,2.6804177538958625,2.3730511024749026,1.8072387769761127,0.8396864948523932,1.4163875927116658,8.29953115762547,1.697549788273217,5.535117629307096,1.767291029510516,5.283031231445714,5.042176759063158,3.636096606417536,1.6699583142585004,0.3448231261601764,4.5628394124216625,0.51328975850672,0.5302662053924552,5.565611158123546,5.4558843623984865,2.892276719914995,2.381341027350035,1.6287603535141555,3.456899954425105,1.953239408088689,0.10093891834520896,1.4501411090986425,3.27306176334693,-0.03715950744689156,1.0613493259592728,3.045466917917314,5.865221754960095,3.1444457435489257,2.882106823134497,6.304284002009429,0.9127255055790835,1.5057636081199197,4.341430493818934,4.762627963621312,3.648338954602969,-1.8905919943636365,4.154779402364565,4.025997890128768,2.9080207311089685,4.023435659858433,5.358803256948495,2.916564521563868,1.1397412365898143,-0.4859007675345577,2.939297697422192,1.5393534107508424,1.8131035925266117,0.7860520550727967,3.3182197915652916,4.14913778551064,3.6062697345367996,0.8084219979583356,4.42486628438319,3.390608487752808,-1.6539120491319448,3.8971314850527383,-0.8400556791667695,0.775589011269056,4.728252101669532,3.999479358763021,1.6644556535291253,1.2342642224266553,3.446742257988004,-0.4097934417336253,3.5637733005901664,2.299213778231617,4.145961753655331,2.598603788986998,0.8651646392377605,3.188511650522199,2.1947940645644914,0.2661975688483613,0.730036981317423,1.0124786686781588,2.9145351538399327,4.202270229636732,2.773169206581195,0.6543339059973787,2.13771527029522,3.8448145346669564,4.763702128131803,1.1318502839109241,3.3349888054201946,2.1219191211023043,-1.0529280070927145,0.49406523882872033,1.8052987358859847,1.8926194084055714,2.1119150324157028,1.737844545113382,3.485803190175507,1.0982747201805028,-0.0470381143201557],"y":[1.393063450662071,1.8683264502831296,2.375911035896644,2.5705565715812533,2.480923651947025,2.060218248685585,1.495911515897582,2.100846637877444,5.486045632205563,1.9059385755525913,3.9677709986671292,1.613489877214887,3.5951509891345967,3.5619649476515125,2.8062097474814873,1.6363894606522127,1.5533179878043644,3.3879247151362737,1.4792633063533902,0.876404650182474,3.630713479251975,3.5214073358080356,2.3924003658571085,2.696700684367798,2.5756942724490095,2.790055424967436,2.0908803720690763,0.9937851792248047,1.5654756038457354,2.904957432278687,0.861006043308068,1.2207599413354568,2.715764856623034,3.8869730940243574,2.6729576971903573,2.5386903708639856,4.4477557391976585,1.6487243319035318,2.0341774720660784,3.1472272466618954,3.359382063186567,2.948615696267284,0.13860420610337698,3.2362688571226332,3.13392835730985,3.113362559987298,2.965249953535894,3.835131252494742,2.510088673224624,1.9823465636965523,0.539726379460765,2.109794595497851,2.139782213182384,2.1417338145156446,1.459063917082327,2.4408758922712472,3.463131482267203,2.9410272100548536,1.2341296138956714,3.0741299485494036,2.5068499815651446,0.5984481982534025,2.899700756818474,0.27644970632409205,1.2152138297478619,3.701826110150874,3.186923955633036,1.6228280184042863,1.270182685450818,2.5508895095092736,0.8803724816378047,2.660323096635855,1.980008863312145,3.080568638159166,2.127775755543418,1.1027831918034998,2.172576728854949,1.8167246725185535,0.9177401220665597,1.4417928878292763,1.5311111337075598,2.207411016693051,3.4308905993162764,2.023642734666465,1.6164734016530833,1.719834506485098,2.823497280952788,3.631395313031174,1.826747225557673,2.4121899014664407,2.0838215951594243,0.13706652759009508,1.1864567918042983,2.0304404615247638,1.78193976117044,2.5015900907183823,2.0190170283794213,2.9490205755063457,1.3808413169593923,0.9382562839234225],"type":"scatter"},{"marker":{"color":"rgba(21, 96, 130, 0.7)","size":12,"symbol":"circle"},"mode":"markers","showlegend":false,"x":[-2.435257509594034],"y":[-2.2555973138035217],"type":"scatter"},{"marker":{"color":"rgba(233, 113, 50, 0.7)","size":12,"symbol":"square"},"mode":"markers","showlegend":false,"x":[2.435257509594025],"y":[2.2555973138035146],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"xaxis":{"title":{"text":"# of assignments turned in"},"scaleanchor":"y","scaleratio":1},"yaxis":{"title":{"text":"average grade"},"scaleanchor":"x","scaleratio":1},"width":500,"height":400},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('fc424357-08ba-4571-aadf-ea5b2c9066fc');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div>
</div>
<p>Looking at the data, we can see that the number of assignments turned in correlates with the average grade. Both average grade and number of assignments turned in also seem predictive of the students’ performance on the final. Which feature will our probes pick out?</p>
<section id="Logistic-regression-probe-(LR)">
<h3>Logistic regression probe (LR)<a class="headerlink" href="#Logistic-regression-probe-(LR)" title="Link to this heading">#</a></h3>
<p>Logistic regression will find the boundary that maximizes the margin between the students who passed and failed the final. However, it’s <strong>likely to pick up on spurious correlations that don’t drive the difference between the two groups!</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogisticRegression</span>

<span class="n">lr_probe</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">lr_probe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">lr_probe</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="n">lr_probe</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">theta</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 0.56890804, -3.07920493])
</pre></div></div>
</div>
<p>Let’s visualize the boundary drawn by our logistic regression probe. It neatly classifies between students who passed and students who failed the final!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">plotly.graph_objects</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">go</span>

<span class="c1"># flip x &amp; y -? flip around 45-degree line</span>
<span class="c1"># negate x -&gt; flip around y-axis</span>
<span class="n">theta_orthogonal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">theta</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>

<span class="c1"># add trendline</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">probe_x</span> <span class="o">=</span> <span class="n">t</span> <span class="o">*</span> <span class="n">theta_orthogonal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">probe_y</span> <span class="o">=</span> <span class="n">t</span> <span class="o">*</span> <span class="n">theta_orthogonal</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
  <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">probe_x</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">probe_y</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">COLORS</span><span class="o">.</span><span class="n">PURPLE</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s1">&#39;dash&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;LR probe&#39;</span>
  <span class="p">)</span>
<span class="p">)</span>

<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="9968039f-ee98-4cb0-a561-53b5cd4e3d8d" class="plotly-graph-div" style="height:400px; width:500px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("9968039f-ee98-4cb0-a561-53b5cd4e3d8d")) {                    Plotly.newPlot(                        "9968039f-ee98-4cb0-a561-53b5cd4e3d8d",                        [{"marker":{"color":"rgba(70, 177, 225, 0.5)","size":10,"symbol":"circle"},"mode":"markers","name":"failed final","x":[-1.324129517162433,-3.4020705968353964,-1.739112919801535,-5.2368281551133915,-0.8198469127358345,-4.938002426218874,-2.1662752732063044,-2.3919138201255397,-3.6280713952757075,2.993770897135655,-3.2515852687758144,-1.3250814254800316,-0.2027830014289842,-4.362807855810381,0.24073745474397246,-2.3953736316473764,-0.352976155285484,-3.8204684779149582,-4.028658387118494,0.002129595492641023,-1.2721338670421352,-1.9255808949631747,-1.0221340098293856,-1.226305216645204,-4.253352437234434,-6.1595042767586765,-5.202665732555625,-5.39407366575628,-6.168866914900917,-3.340879418142472,-3.1266317913102464,-2.2460805285361385,-1.7885473066960431,-2.8673498584407016,-2.6325313544097897,-2.0436502795573004,-3.970470921208813,-3.460445331536479,-2.111754590791528,-3.3958056710652613,-3.2048899247001135,-2.366056181442598,0.22899239576478791,-1.601906495415351,-2.7831754639344606,-3.228986914257728,-2.382359907265953,1.859768016067025,-7.84085375262356,-1.2122594059401859,-1.7570212229536226,-0.6138025022562852,-4.242286899487684,1.6303156207755238,-0.3738070446032866,-2.268051005359405,-1.8878861573123489,-3.4647784692293233,-2.0845629260987293,-2.4335113600325142,-0.47706831090694024,-1.5317444079996543,-2.3257125789284006,-0.9554530285905196,-1.1745953407628242,-1.774608984309908,-4.92767787692107,-0.32292389785658404,-4.27476978086262,-3.992714988001323,-2.3649863935001783,-1.2538641292037047,0.3584059608525809,-5.213357409729115,0.4727171728980073,0.7701292195534393,-3.0060148990384397,-2.5379561001260935,-3.204774128352668,-3.261442420379977,-4.58640461181945,-5.2168792704813,-2.5342932245378362,-1.7115133600072907,1.1163732732903933,-3.9773067948700245,-5.940548197867221,-1.9116965432016553,-3.0149359972169165,-1.5343026006916007,-2.8916875333798453,-4.442106341941019,-3.4154856602460573,-0.7307692033990456,-1.6852001406769972,-3.92002171141843,-0.6059613942788014,-4.778951010877936,-3.141170288886949,-1.8192470844787776],"y":[-1.5084909726111597,-2.885229472594647,-1.631001581692166,-3.8674186057986164,-1.0157654879649325,-3.8393068555221905,-2.4426419012909513,-1.9857959480687004,-2.2790233921274066,0.25930724605371047,-2.153523888640221,-1.2047246772944433,-0.8630998399945362,-3.2452532144986215,-1.5335322455566782,-2.666550356413116,-1.418072174073636,-2.7587687249631827,-3.0710651676784257,-1.196879180392946,-1.6096918979921249,-2.459001050787302,-1.395715947317223,-1.8988375360361234,-2.7444015396622152,-4.033279343994228,-3.829555292496064,-3.8568259575951718,-4.566504945659663,-2.619626073075093,-2.865231779425944,-2.1563430932234464,-1.5509450672538403,-2.3309572140382855,-2.1722943568002613,-1.2287943337206801,-2.776586206740804,-2.395535013811024,-2.1318656088884955,-3.055371239330766,-2.533763872147258,-2.530751179752416,-1.7889614482693847,-1.6214454358410588,-2.2908528444155003,-2.9350209041315782,-1.8030283977456785,-0.09445542501861048,-5.0620970321170455,-1.893927080500207,-1.5309987131544265,-1.4390440850980415,-3.2727196744402267,-0.3260231811852883,-1.42301495964338,-2.640644100642529,-2.1649749741049407,-2.997367694085753,-1.832649093875018,-2.610773611343885,-1.0324505675192714,-1.921450008215868,-2.4070647332231196,-1.529599426123223,-1.5762300635581905,-1.8556060549730606,-3.2897335766438864,-1.0970318819767133,-3.602962219616967,-3.2030350879500755,-1.693793490930915,-1.6618147439415898,-1.5240545586121925,-3.5551845430085978,-0.25233502132285146,-0.2629487648150448,-2.4850890976993627,-2.202296834430358,-2.407397655509487,-2.6768825523533817,-3.438531626232626,-3.1174859700844433,-2.3861972765646113,-1.551631721725455,-0.9137518866562893,-3.223833404975821,-4.315891363331693,-1.8313677039603302,-2.696114700680152,-1.961091839488776,-2.7220444303148037,-3.1767871254237567,-2.413772221647964,-1.5439941531598738,-1.6591533699206398,-2.9642748220717454,-1.48813159585589,-3.2841754033728003,-2.168020752137963,-2.6898054838385015],"type":"scatter"},{"marker":{"color":"rgba(242, 170, 132, 0.5)","size":10,"symbol":"square"},"mode":"markers","name":"passed final","x":[0.3663443210899322,0.6744960970462222,2.8531781629248476,2.6804177538958625,2.3730511024749026,1.8072387769761127,0.8396864948523932,1.4163875927116658,8.29953115762547,1.697549788273217,5.535117629307096,1.767291029510516,5.283031231445714,5.042176759063158,3.636096606417536,1.6699583142585004,0.3448231261601764,4.5628394124216625,0.51328975850672,0.5302662053924552,5.565611158123546,5.4558843623984865,2.892276719914995,2.381341027350035,1.6287603535141555,3.456899954425105,1.953239408088689,0.10093891834520896,1.4501411090986425,3.27306176334693,-0.03715950744689156,1.0613493259592728,3.045466917917314,5.865221754960095,3.1444457435489257,2.882106823134497,6.304284002009429,0.9127255055790835,1.5057636081199197,4.341430493818934,4.762627963621312,3.648338954602969,-1.8905919943636365,4.154779402364565,4.025997890128768,2.9080207311089685,4.023435659858433,5.358803256948495,2.916564521563868,1.1397412365898143,-0.4859007675345577,2.939297697422192,1.5393534107508424,1.8131035925266117,0.7860520550727967,3.3182197915652916,4.14913778551064,3.6062697345367996,0.8084219979583356,4.42486628438319,3.390608487752808,-1.6539120491319448,3.8971314850527383,-0.8400556791667695,0.775589011269056,4.728252101669532,3.999479358763021,1.6644556535291253,1.2342642224266553,3.446742257988004,-0.4097934417336253,3.5637733005901664,2.299213778231617,4.145961753655331,2.598603788986998,0.8651646392377605,3.188511650522199,2.1947940645644914,0.2661975688483613,0.730036981317423,1.0124786686781588,2.9145351538399327,4.202270229636732,2.773169206581195,0.6543339059973787,2.13771527029522,3.8448145346669564,4.763702128131803,1.1318502839109241,3.3349888054201946,2.1219191211023043,-1.0529280070927145,0.49406523882872033,1.8052987358859847,1.8926194084055714,2.1119150324157028,1.737844545113382,3.485803190175507,1.0982747201805028,-0.0470381143201557],"y":[1.393063450662071,1.8683264502831296,2.375911035896644,2.5705565715812533,2.480923651947025,2.060218248685585,1.495911515897582,2.100846637877444,5.486045632205563,1.9059385755525913,3.9677709986671292,1.613489877214887,3.5951509891345967,3.5619649476515125,2.8062097474814873,1.6363894606522127,1.5533179878043644,3.3879247151362737,1.4792633063533902,0.876404650182474,3.630713479251975,3.5214073358080356,2.3924003658571085,2.696700684367798,2.5756942724490095,2.790055424967436,2.0908803720690763,0.9937851792248047,1.5654756038457354,2.904957432278687,0.861006043308068,1.2207599413354568,2.715764856623034,3.8869730940243574,2.6729576971903573,2.5386903708639856,4.4477557391976585,1.6487243319035318,2.0341774720660784,3.1472272466618954,3.359382063186567,2.948615696267284,0.13860420610337698,3.2362688571226332,3.13392835730985,3.113362559987298,2.965249953535894,3.835131252494742,2.510088673224624,1.9823465636965523,0.539726379460765,2.109794595497851,2.139782213182384,2.1417338145156446,1.459063917082327,2.4408758922712472,3.463131482267203,2.9410272100548536,1.2341296138956714,3.0741299485494036,2.5068499815651446,0.5984481982534025,2.899700756818474,0.27644970632409205,1.2152138297478619,3.701826110150874,3.186923955633036,1.6228280184042863,1.270182685450818,2.5508895095092736,0.8803724816378047,2.660323096635855,1.980008863312145,3.080568638159166,2.127775755543418,1.1027831918034998,2.172576728854949,1.8167246725185535,0.9177401220665597,1.4417928878292763,1.5311111337075598,2.207411016693051,3.4308905993162764,2.023642734666465,1.6164734016530833,1.719834506485098,2.823497280952788,3.631395313031174,1.826747225557673,2.4121899014664407,2.0838215951594243,0.13706652759009508,1.1864567918042983,2.0304404615247638,1.78193976117044,2.5015900907183823,2.0190170283794213,2.9490205755063457,1.3808413169593923,0.9382562839234225],"type":"scatter"},{"marker":{"color":"rgba(21, 96, 130, 0.7)","size":12,"symbol":"circle"},"mode":"markers","showlegend":false,"x":[-2.435257509594034],"y":[-2.2555973138035217],"type":"scatter"},{"marker":{"color":"rgba(233, 113, 50, 0.7)","size":12,"symbol":"square"},"mode":"markers","showlegend":false,"x":[2.435257509594025],"y":[2.2555973138035146],"type":"scatter"},{"line":{"color":"#A02B93","dash":"dash","width":2},"mode":"lines","name":"LR probe","x":[-6.158409855679303,-6.033997535362549,-5.909585215045796,-5.785172894729043,-5.660760574412289,-5.536348254095535,-5.411935933778782,-5.287523613462028,-5.163111293145274,-5.03869897282852,-4.914286652511767,-4.789874332195014,-4.66546201187826,-4.541049691561506,-4.416637371244753,-4.292225050928,-4.167812730611245,-4.043400410294492,-3.9189880899777383,-3.7945757696609848,-3.6701634493442308,-3.5457511290274772,-3.421338808710724,-3.2969264883939697,-3.1725141680772166,-3.048101847760463,-2.923689527443709,-2.7992772071269556,-2.674864886810202,-2.550452566493449,-2.426040246176695,-2.3016279258599415,-2.1772156055431875,-2.052803285226434,-1.9283909649096802,-1.8039786445929265,-1.6795663242761736,-1.5551540039594198,-1.430741683642666,-1.3063293633259123,-1.1819170430091586,-1.0575047226924048,-0.9330924023756518,-0.8086800820588982,-0.6842677617421444,-0.5598554414253907,-0.435443121108637,-0.3110308007918833,-0.18661848047513024,-0.06220616015837652,0.062206160158377204,0.1866184804751316,0.3110308007918846,0.43544312110863764,0.5598554414253921,0.6842677617421451,0.8086800820588995,0.9330924023756525,1.0575047226924055,1.18191704300916,1.306329363325913,1.4307416836426674,1.5551540039594205,1.679566324276175,1.8039786445929278,1.9283909649096809,2.0528032852264353,2.1772156055431884,2.301627925859943,2.426040246176696,2.5504525664934503,2.6748648868102034,2.799277207126956,2.9236895274437105,3.0481018477604636,3.172514168077218,3.296926488393971,3.421338808710724,3.5457511290274786,3.6701634493442317,3.794575769660986,3.918988089977739,4.043400410294494,4.167812730611247,4.292225050928,4.416637371244754,4.541049691561507,4.665462011878262,4.789874332195015,4.914286652511769,5.038698972828522,5.163111293145275,5.287523613462029,5.411935933778782,5.536348254095537,5.66076057441229,5.785172894729043,5.909585215045797,6.03399753536255,6.158409855679303],"y":[-1.1378160797126338,-1.1148298962840957,-1.0918437128555576,-1.0688575294270197,-1.0458713459984816,-1.0228851625699436,-0.9998989791414055,-0.9769127957128674,-0.9539266122843293,-0.9309404288557912,-0.9079542454272532,-0.8849680619987151,-0.861981878570177,-0.838995695141639,-0.8160095117131009,-0.793023328284563,-0.7700371448560248,-0.7470509614274868,-0.7240647779989487,-0.7010785945704107,-0.6780924111418726,-0.6551062277133345,-0.6321200442847965,-0.6091338608562583,-0.5861476774277204,-0.5631614939991824,-0.5401753105706443,-0.5171891271421062,-0.4942029437135681,-0.4712167602850301,-0.4482305768564921,-0.425244393427954,-0.4022582099994159,-0.37927202657087783,-0.35628584314233974,-0.33329965971380165,-0.31031347628526373,-0.28732729285672565,-0.26434110942818756,-0.2413549259996495,-0.2183687425711114,-0.19538255914257335,-0.1723963757140354,-0.14941019228549732,-0.12642400885695923,-0.10343782542842116,-0.08045164199988308,-0.057465458571345,-0.034479275142807055,-0.011493091714268976,0.011493091714269103,0.034479275142807304,0.05746545857134526,0.08045164199988321,0.1034378254284214,0.12642400885695937,0.14941019228549757,0.17239637571403552,0.19538255914257346,0.21836874257111166,0.24135492599964964,0.26434110942818784,0.28732729285672576,0.310313476285264,0.33329965971380193,0.3562858431423399,0.3792720265708781,0.402258209999416,0.4252443934279542,0.4482305768564922,0.4712167602850304,0.4942029437135684,0.5171891271421063,0.5401753105706445,0.5631614939991825,0.5861476774277207,0.6091338608562586,0.6321200442847965,0.6551062277133348,0.6780924111418727,0.7010785945704109,0.7240647779989489,0.7470509614274871,0.770037144856025,0.793023328284563,0.8160095117131012,0.8389956951416392,0.8619818785701774,0.8849680619987152,0.9079542454272534,0.9309404288557914,0.9539266122843294,0.9769127957128676,0.9998989791414056,1.0228851625699438,1.0458713459984816,1.0688575294270197,1.0918437128555578,1.114829896284096,1.1378160797126338],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"xaxis":{"title":{"text":"# of assignments turned in"},"scaleanchor":"y","scaleratio":1},"yaxis":{"title":{"text":"average grade"},"scaleanchor":"x","scaleratio":1},"width":500,"height":400},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('9968039f-ee98-4cb0-a561-53b5cd4e3d8d');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div>
</div>
<p>But what is the <strong>direction</strong> of our probe? What <strong>intervention</strong> does it suggest to shift students who failed the final towards passing the final next year?</p>
<p>Because grade and # of assignments is correlated, the LR probe does away with # of assignments and uses the average grade to classify students. But what sort of intervention does this suggest?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mean_low_transformed</span> <span class="o">=</span> <span class="n">mean_low</span> <span class="o">-</span> <span class="n">theta</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span>
  <span class="n">ax</span><span class="o">=</span><span class="n">mean_low</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  <span class="c1"># x-coordinate of the arrow&#39;s head</span>
  <span class="n">ay</span><span class="o">=</span><span class="n">mean_low</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.2</span><span class="p">,</span>  <span class="c1"># y-coordinate of the arrow&#39;s head</span>
  <span class="n">x</span><span class="o">=</span><span class="n">mean_low_transformed</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="c1"># x-coordinate of the arrow&#39;s tail</span>
  <span class="n">y</span><span class="o">=</span><span class="n">mean_low_transformed</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.2</span><span class="p">,</span> <span class="c1"># y-coordinate of the arrow&#39;s tail</span>
  <span class="n">xref</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">yref</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="c1"># Reference coordinates to the plot&#39;s x and y axes</span>
  <span class="n">axref</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">ayref</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>
  <span class="n">showarrow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
  <span class="n">arrowhead</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="c1"># Style of the arrowhead (e.g., 1, 2, 3, 4, 5)</span>
  <span class="n">arrowsize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
  <span class="n">arrowwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
  <span class="n">arrowcolor</span><span class="o">=</span><span class="n">COLORS</span><span class="o">.</span><span class="n">PURPLE</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="f00ddf62-2f51-464d-a92f-d8b32e0f9377" class="plotly-graph-div" style="height:400px; width:500px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("f00ddf62-2f51-464d-a92f-d8b32e0f9377")) {                    Plotly.newPlot(                        "f00ddf62-2f51-464d-a92f-d8b32e0f9377",                        [{"marker":{"color":"rgba(70, 177, 225, 0.5)","size":10,"symbol":"circle"},"mode":"markers","name":"failed final","x":[-1.324129517162433,-3.4020705968353964,-1.739112919801535,-5.2368281551133915,-0.8198469127358345,-4.938002426218874,-2.1662752732063044,-2.3919138201255397,-3.6280713952757075,2.993770897135655,-3.2515852687758144,-1.3250814254800316,-0.2027830014289842,-4.362807855810381,0.24073745474397246,-2.3953736316473764,-0.352976155285484,-3.8204684779149582,-4.028658387118494,0.002129595492641023,-1.2721338670421352,-1.9255808949631747,-1.0221340098293856,-1.226305216645204,-4.253352437234434,-6.1595042767586765,-5.202665732555625,-5.39407366575628,-6.168866914900917,-3.340879418142472,-3.1266317913102464,-2.2460805285361385,-1.7885473066960431,-2.8673498584407016,-2.6325313544097897,-2.0436502795573004,-3.970470921208813,-3.460445331536479,-2.111754590791528,-3.3958056710652613,-3.2048899247001135,-2.366056181442598,0.22899239576478791,-1.601906495415351,-2.7831754639344606,-3.228986914257728,-2.382359907265953,1.859768016067025,-7.84085375262356,-1.2122594059401859,-1.7570212229536226,-0.6138025022562852,-4.242286899487684,1.6303156207755238,-0.3738070446032866,-2.268051005359405,-1.8878861573123489,-3.4647784692293233,-2.0845629260987293,-2.4335113600325142,-0.47706831090694024,-1.5317444079996543,-2.3257125789284006,-0.9554530285905196,-1.1745953407628242,-1.774608984309908,-4.92767787692107,-0.32292389785658404,-4.27476978086262,-3.992714988001323,-2.3649863935001783,-1.2538641292037047,0.3584059608525809,-5.213357409729115,0.4727171728980073,0.7701292195534393,-3.0060148990384397,-2.5379561001260935,-3.204774128352668,-3.261442420379977,-4.58640461181945,-5.2168792704813,-2.5342932245378362,-1.7115133600072907,1.1163732732903933,-3.9773067948700245,-5.940548197867221,-1.9116965432016553,-3.0149359972169165,-1.5343026006916007,-2.8916875333798453,-4.442106341941019,-3.4154856602460573,-0.7307692033990456,-1.6852001406769972,-3.92002171141843,-0.6059613942788014,-4.778951010877936,-3.141170288886949,-1.8192470844787776],"y":[-1.5084909726111597,-2.885229472594647,-1.631001581692166,-3.8674186057986164,-1.0157654879649325,-3.8393068555221905,-2.4426419012909513,-1.9857959480687004,-2.2790233921274066,0.25930724605371047,-2.153523888640221,-1.2047246772944433,-0.8630998399945362,-3.2452532144986215,-1.5335322455566782,-2.666550356413116,-1.418072174073636,-2.7587687249631827,-3.0710651676784257,-1.196879180392946,-1.6096918979921249,-2.459001050787302,-1.395715947317223,-1.8988375360361234,-2.7444015396622152,-4.033279343994228,-3.829555292496064,-3.8568259575951718,-4.566504945659663,-2.619626073075093,-2.865231779425944,-2.1563430932234464,-1.5509450672538403,-2.3309572140382855,-2.1722943568002613,-1.2287943337206801,-2.776586206740804,-2.395535013811024,-2.1318656088884955,-3.055371239330766,-2.533763872147258,-2.530751179752416,-1.7889614482693847,-1.6214454358410588,-2.2908528444155003,-2.9350209041315782,-1.8030283977456785,-0.09445542501861048,-5.0620970321170455,-1.893927080500207,-1.5309987131544265,-1.4390440850980415,-3.2727196744402267,-0.3260231811852883,-1.42301495964338,-2.640644100642529,-2.1649749741049407,-2.997367694085753,-1.832649093875018,-2.610773611343885,-1.0324505675192714,-1.921450008215868,-2.4070647332231196,-1.529599426123223,-1.5762300635581905,-1.8556060549730606,-3.2897335766438864,-1.0970318819767133,-3.602962219616967,-3.2030350879500755,-1.693793490930915,-1.6618147439415898,-1.5240545586121925,-3.5551845430085978,-0.25233502132285146,-0.2629487648150448,-2.4850890976993627,-2.202296834430358,-2.407397655509487,-2.6768825523533817,-3.438531626232626,-3.1174859700844433,-2.3861972765646113,-1.551631721725455,-0.9137518866562893,-3.223833404975821,-4.315891363331693,-1.8313677039603302,-2.696114700680152,-1.961091839488776,-2.7220444303148037,-3.1767871254237567,-2.413772221647964,-1.5439941531598738,-1.6591533699206398,-2.9642748220717454,-1.48813159585589,-3.2841754033728003,-2.168020752137963,-2.6898054838385015],"type":"scatter"},{"marker":{"color":"rgba(242, 170, 132, 0.5)","size":10,"symbol":"square"},"mode":"markers","name":"passed final","x":[0.3663443210899322,0.6744960970462222,2.8531781629248476,2.6804177538958625,2.3730511024749026,1.8072387769761127,0.8396864948523932,1.4163875927116658,8.29953115762547,1.697549788273217,5.535117629307096,1.767291029510516,5.283031231445714,5.042176759063158,3.636096606417536,1.6699583142585004,0.3448231261601764,4.5628394124216625,0.51328975850672,0.5302662053924552,5.565611158123546,5.4558843623984865,2.892276719914995,2.381341027350035,1.6287603535141555,3.456899954425105,1.953239408088689,0.10093891834520896,1.4501411090986425,3.27306176334693,-0.03715950744689156,1.0613493259592728,3.045466917917314,5.865221754960095,3.1444457435489257,2.882106823134497,6.304284002009429,0.9127255055790835,1.5057636081199197,4.341430493818934,4.762627963621312,3.648338954602969,-1.8905919943636365,4.154779402364565,4.025997890128768,2.9080207311089685,4.023435659858433,5.358803256948495,2.916564521563868,1.1397412365898143,-0.4859007675345577,2.939297697422192,1.5393534107508424,1.8131035925266117,0.7860520550727967,3.3182197915652916,4.14913778551064,3.6062697345367996,0.8084219979583356,4.42486628438319,3.390608487752808,-1.6539120491319448,3.8971314850527383,-0.8400556791667695,0.775589011269056,4.728252101669532,3.999479358763021,1.6644556535291253,1.2342642224266553,3.446742257988004,-0.4097934417336253,3.5637733005901664,2.299213778231617,4.145961753655331,2.598603788986998,0.8651646392377605,3.188511650522199,2.1947940645644914,0.2661975688483613,0.730036981317423,1.0124786686781588,2.9145351538399327,4.202270229636732,2.773169206581195,0.6543339059973787,2.13771527029522,3.8448145346669564,4.763702128131803,1.1318502839109241,3.3349888054201946,2.1219191211023043,-1.0529280070927145,0.49406523882872033,1.8052987358859847,1.8926194084055714,2.1119150324157028,1.737844545113382,3.485803190175507,1.0982747201805028,-0.0470381143201557],"y":[1.393063450662071,1.8683264502831296,2.375911035896644,2.5705565715812533,2.480923651947025,2.060218248685585,1.495911515897582,2.100846637877444,5.486045632205563,1.9059385755525913,3.9677709986671292,1.613489877214887,3.5951509891345967,3.5619649476515125,2.8062097474814873,1.6363894606522127,1.5533179878043644,3.3879247151362737,1.4792633063533902,0.876404650182474,3.630713479251975,3.5214073358080356,2.3924003658571085,2.696700684367798,2.5756942724490095,2.790055424967436,2.0908803720690763,0.9937851792248047,1.5654756038457354,2.904957432278687,0.861006043308068,1.2207599413354568,2.715764856623034,3.8869730940243574,2.6729576971903573,2.5386903708639856,4.4477557391976585,1.6487243319035318,2.0341774720660784,3.1472272466618954,3.359382063186567,2.948615696267284,0.13860420610337698,3.2362688571226332,3.13392835730985,3.113362559987298,2.965249953535894,3.835131252494742,2.510088673224624,1.9823465636965523,0.539726379460765,2.109794595497851,2.139782213182384,2.1417338145156446,1.459063917082327,2.4408758922712472,3.463131482267203,2.9410272100548536,1.2341296138956714,3.0741299485494036,2.5068499815651446,0.5984481982534025,2.899700756818474,0.27644970632409205,1.2152138297478619,3.701826110150874,3.186923955633036,1.6228280184042863,1.270182685450818,2.5508895095092736,0.8803724816378047,2.660323096635855,1.980008863312145,3.080568638159166,2.127775755543418,1.1027831918034998,2.172576728854949,1.8167246725185535,0.9177401220665597,1.4417928878292763,1.5311111337075598,2.207411016693051,3.4308905993162764,2.023642734666465,1.6164734016530833,1.719834506485098,2.823497280952788,3.631395313031174,1.826747225557673,2.4121899014664407,2.0838215951594243,0.13706652759009508,1.1864567918042983,2.0304404615247638,1.78193976117044,2.5015900907183823,2.0190170283794213,2.9490205755063457,1.3808413169593923,0.9382562839234225],"type":"scatter"},{"marker":{"color":"rgba(21, 96, 130, 0.7)","size":12,"symbol":"circle"},"mode":"markers","showlegend":false,"x":[-2.435257509594034],"y":[-2.2555973138035217],"type":"scatter"},{"marker":{"color":"rgba(233, 113, 50, 0.7)","size":12,"symbol":"square"},"mode":"markers","showlegend":false,"x":[2.435257509594025],"y":[2.2555973138035146],"type":"scatter"},{"line":{"color":"#A02B93","dash":"dash","width":2},"mode":"lines","name":"LR probe","x":[-6.158409855679303,-6.033997535362549,-5.909585215045796,-5.785172894729043,-5.660760574412289,-5.536348254095535,-5.411935933778782,-5.287523613462028,-5.163111293145274,-5.03869897282852,-4.914286652511767,-4.789874332195014,-4.66546201187826,-4.541049691561506,-4.416637371244753,-4.292225050928,-4.167812730611245,-4.043400410294492,-3.9189880899777383,-3.7945757696609848,-3.6701634493442308,-3.5457511290274772,-3.421338808710724,-3.2969264883939697,-3.1725141680772166,-3.048101847760463,-2.923689527443709,-2.7992772071269556,-2.674864886810202,-2.550452566493449,-2.426040246176695,-2.3016279258599415,-2.1772156055431875,-2.052803285226434,-1.9283909649096802,-1.8039786445929265,-1.6795663242761736,-1.5551540039594198,-1.430741683642666,-1.3063293633259123,-1.1819170430091586,-1.0575047226924048,-0.9330924023756518,-0.8086800820588982,-0.6842677617421444,-0.5598554414253907,-0.435443121108637,-0.3110308007918833,-0.18661848047513024,-0.06220616015837652,0.062206160158377204,0.1866184804751316,0.3110308007918846,0.43544312110863764,0.5598554414253921,0.6842677617421451,0.8086800820588995,0.9330924023756525,1.0575047226924055,1.18191704300916,1.306329363325913,1.4307416836426674,1.5551540039594205,1.679566324276175,1.8039786445929278,1.9283909649096809,2.0528032852264353,2.1772156055431884,2.301627925859943,2.426040246176696,2.5504525664934503,2.6748648868102034,2.799277207126956,2.9236895274437105,3.0481018477604636,3.172514168077218,3.296926488393971,3.421338808710724,3.5457511290274786,3.6701634493442317,3.794575769660986,3.918988089977739,4.043400410294494,4.167812730611247,4.292225050928,4.416637371244754,4.541049691561507,4.665462011878262,4.789874332195015,4.914286652511769,5.038698972828522,5.163111293145275,5.287523613462029,5.411935933778782,5.536348254095537,5.66076057441229,5.785172894729043,5.909585215045797,6.03399753536255,6.158409855679303],"y":[-1.1378160797126338,-1.1148298962840957,-1.0918437128555576,-1.0688575294270197,-1.0458713459984816,-1.0228851625699436,-0.9998989791414055,-0.9769127957128674,-0.9539266122843293,-0.9309404288557912,-0.9079542454272532,-0.8849680619987151,-0.861981878570177,-0.838995695141639,-0.8160095117131009,-0.793023328284563,-0.7700371448560248,-0.7470509614274868,-0.7240647779989487,-0.7010785945704107,-0.6780924111418726,-0.6551062277133345,-0.6321200442847965,-0.6091338608562583,-0.5861476774277204,-0.5631614939991824,-0.5401753105706443,-0.5171891271421062,-0.4942029437135681,-0.4712167602850301,-0.4482305768564921,-0.425244393427954,-0.4022582099994159,-0.37927202657087783,-0.35628584314233974,-0.33329965971380165,-0.31031347628526373,-0.28732729285672565,-0.26434110942818756,-0.2413549259996495,-0.2183687425711114,-0.19538255914257335,-0.1723963757140354,-0.14941019228549732,-0.12642400885695923,-0.10343782542842116,-0.08045164199988308,-0.057465458571345,-0.034479275142807055,-0.011493091714268976,0.011493091714269103,0.034479275142807304,0.05746545857134526,0.08045164199988321,0.1034378254284214,0.12642400885695937,0.14941019228549757,0.17239637571403552,0.19538255914257346,0.21836874257111166,0.24135492599964964,0.26434110942818784,0.28732729285672576,0.310313476285264,0.33329965971380193,0.3562858431423399,0.3792720265708781,0.402258209999416,0.4252443934279542,0.4482305768564922,0.4712167602850304,0.4942029437135684,0.5171891271421063,0.5401753105706445,0.5631614939991825,0.5861476774277207,0.6091338608562586,0.6321200442847965,0.6551062277133348,0.6780924111418727,0.7010785945704109,0.7240647779989489,0.7470509614274871,0.770037144856025,0.793023328284563,0.8160095117131012,0.8389956951416392,0.8619818785701774,0.8849680619987152,0.9079542454272534,0.9309404288557914,0.9539266122843294,0.9769127957128676,0.9998989791414056,1.0228851625699438,1.0458713459984816,1.0688575294270197,1.0918437128555578,1.114829896284096,1.1378160797126338],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"xaxis":{"title":{"text":"# of assignments turned in"},"scaleanchor":"y","scaleratio":1},"yaxis":{"title":{"text":"average grade"},"scaleanchor":"x","scaleratio":1},"width":500,"height":400,"annotations":[{"arrowcolor":"#A02B93","arrowhead":4,"arrowsize":2,"arrowwidth":1,"ax":-2.435257509594034,"axref":"x","ay":-2.0555973138035215,"ayref":"y","showarrow":true,"x":-3.004165549450351,"xref":"x","y":0.62360761403613,"yref":"y"}]},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('f00ddf62-2f51-464d-a92f-d8b32e0f9377');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div>
</div>
<p>Presumably, bumping everyone’s grades’ up won’t have the intended effect of helping people pass the final! Indeed, if we draw an arrow in the direction of the linear probe, we see that it doesn’t do a great job at bringing the two distributions of students close together.</p>
<p>In this case, the <strong>direction</strong> of the LR probe isn’t meaningful - it tells the students apart, but doesn’t help us <strong>steer</strong> a student who’s on track to fail the class towards passing it.</p>
</section>
<section id="Difference-in-means-probe-(aka.-mean-mass-/-MM)">
<h3>Difference in means probe (aka. mean mass / MM)<a class="headerlink" href="#Difference-in-means-probe-(aka.-mean-mass-/-MM)" title="Link to this heading">#</a></h3>
<p>A simple but effective alternative to LR probes is <strong>difference in means</strong> (also known as <strong>mean mass</strong>) probing.</p>
<p>To classify between groups of students, we take the difference between the mean student who passed the final and the mean student who didn’t pass. What we get is a direction vector that roughly tells the two classes apart, but more importantly tells us how to bridge between the two distribution.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mean_mass_probe</span> <span class="o">=</span> <span class="n">mean_high</span> <span class="o">-</span> <span class="n">mean_low</span>

<span class="n">mean_mass_probe_orthogonal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">mean_mass_probe</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">mean_mass_probe</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>

<span class="c1"># add trendline</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">probe_x</span> <span class="o">=</span> <span class="n">t</span> <span class="o">*</span> <span class="n">mean_mass_probe_orthogonal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">probe_y</span> <span class="o">=</span> <span class="n">t</span> <span class="o">*</span> <span class="n">mean_mass_probe_orthogonal</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">probe_x</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">probe_y</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">COLORS</span><span class="o">.</span><span class="n">GREEN</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s1">&#39;dash&#39;</span><span class="p">),</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;MM probe&#39;</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="d7e6e070-8607-4a77-be56-e33e7c40988f" class="plotly-graph-div" style="height:400px; width:500px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("d7e6e070-8607-4a77-be56-e33e7c40988f")) {                    Plotly.newPlot(                        "d7e6e070-8607-4a77-be56-e33e7c40988f",                        [{"marker":{"color":"rgba(70, 177, 225, 0.5)","size":10,"symbol":"circle"},"mode":"markers","name":"failed final","x":[-1.324129517162433,-3.4020705968353964,-1.739112919801535,-5.2368281551133915,-0.8198469127358345,-4.938002426218874,-2.1662752732063044,-2.3919138201255397,-3.6280713952757075,2.993770897135655,-3.2515852687758144,-1.3250814254800316,-0.2027830014289842,-4.362807855810381,0.24073745474397246,-2.3953736316473764,-0.352976155285484,-3.8204684779149582,-4.028658387118494,0.002129595492641023,-1.2721338670421352,-1.9255808949631747,-1.0221340098293856,-1.226305216645204,-4.253352437234434,-6.1595042767586765,-5.202665732555625,-5.39407366575628,-6.168866914900917,-3.340879418142472,-3.1266317913102464,-2.2460805285361385,-1.7885473066960431,-2.8673498584407016,-2.6325313544097897,-2.0436502795573004,-3.970470921208813,-3.460445331536479,-2.111754590791528,-3.3958056710652613,-3.2048899247001135,-2.366056181442598,0.22899239576478791,-1.601906495415351,-2.7831754639344606,-3.228986914257728,-2.382359907265953,1.859768016067025,-7.84085375262356,-1.2122594059401859,-1.7570212229536226,-0.6138025022562852,-4.242286899487684,1.6303156207755238,-0.3738070446032866,-2.268051005359405,-1.8878861573123489,-3.4647784692293233,-2.0845629260987293,-2.4335113600325142,-0.47706831090694024,-1.5317444079996543,-2.3257125789284006,-0.9554530285905196,-1.1745953407628242,-1.774608984309908,-4.92767787692107,-0.32292389785658404,-4.27476978086262,-3.992714988001323,-2.3649863935001783,-1.2538641292037047,0.3584059608525809,-5.213357409729115,0.4727171728980073,0.7701292195534393,-3.0060148990384397,-2.5379561001260935,-3.204774128352668,-3.261442420379977,-4.58640461181945,-5.2168792704813,-2.5342932245378362,-1.7115133600072907,1.1163732732903933,-3.9773067948700245,-5.940548197867221,-1.9116965432016553,-3.0149359972169165,-1.5343026006916007,-2.8916875333798453,-4.442106341941019,-3.4154856602460573,-0.7307692033990456,-1.6852001406769972,-3.92002171141843,-0.6059613942788014,-4.778951010877936,-3.141170288886949,-1.8192470844787776],"y":[-1.5084909726111597,-2.885229472594647,-1.631001581692166,-3.8674186057986164,-1.0157654879649325,-3.8393068555221905,-2.4426419012909513,-1.9857959480687004,-2.2790233921274066,0.25930724605371047,-2.153523888640221,-1.2047246772944433,-0.8630998399945362,-3.2452532144986215,-1.5335322455566782,-2.666550356413116,-1.418072174073636,-2.7587687249631827,-3.0710651676784257,-1.196879180392946,-1.6096918979921249,-2.459001050787302,-1.395715947317223,-1.8988375360361234,-2.7444015396622152,-4.033279343994228,-3.829555292496064,-3.8568259575951718,-4.566504945659663,-2.619626073075093,-2.865231779425944,-2.1563430932234464,-1.5509450672538403,-2.3309572140382855,-2.1722943568002613,-1.2287943337206801,-2.776586206740804,-2.395535013811024,-2.1318656088884955,-3.055371239330766,-2.533763872147258,-2.530751179752416,-1.7889614482693847,-1.6214454358410588,-2.2908528444155003,-2.9350209041315782,-1.8030283977456785,-0.09445542501861048,-5.0620970321170455,-1.893927080500207,-1.5309987131544265,-1.4390440850980415,-3.2727196744402267,-0.3260231811852883,-1.42301495964338,-2.640644100642529,-2.1649749741049407,-2.997367694085753,-1.832649093875018,-2.610773611343885,-1.0324505675192714,-1.921450008215868,-2.4070647332231196,-1.529599426123223,-1.5762300635581905,-1.8556060549730606,-3.2897335766438864,-1.0970318819767133,-3.602962219616967,-3.2030350879500755,-1.693793490930915,-1.6618147439415898,-1.5240545586121925,-3.5551845430085978,-0.25233502132285146,-0.2629487648150448,-2.4850890976993627,-2.202296834430358,-2.407397655509487,-2.6768825523533817,-3.438531626232626,-3.1174859700844433,-2.3861972765646113,-1.551631721725455,-0.9137518866562893,-3.223833404975821,-4.315891363331693,-1.8313677039603302,-2.696114700680152,-1.961091839488776,-2.7220444303148037,-3.1767871254237567,-2.413772221647964,-1.5439941531598738,-1.6591533699206398,-2.9642748220717454,-1.48813159585589,-3.2841754033728003,-2.168020752137963,-2.6898054838385015],"type":"scatter"},{"marker":{"color":"rgba(242, 170, 132, 0.5)","size":10,"symbol":"square"},"mode":"markers","name":"passed final","x":[0.3663443210899322,0.6744960970462222,2.8531781629248476,2.6804177538958625,2.3730511024749026,1.8072387769761127,0.8396864948523932,1.4163875927116658,8.29953115762547,1.697549788273217,5.535117629307096,1.767291029510516,5.283031231445714,5.042176759063158,3.636096606417536,1.6699583142585004,0.3448231261601764,4.5628394124216625,0.51328975850672,0.5302662053924552,5.565611158123546,5.4558843623984865,2.892276719914995,2.381341027350035,1.6287603535141555,3.456899954425105,1.953239408088689,0.10093891834520896,1.4501411090986425,3.27306176334693,-0.03715950744689156,1.0613493259592728,3.045466917917314,5.865221754960095,3.1444457435489257,2.882106823134497,6.304284002009429,0.9127255055790835,1.5057636081199197,4.341430493818934,4.762627963621312,3.648338954602969,-1.8905919943636365,4.154779402364565,4.025997890128768,2.9080207311089685,4.023435659858433,5.358803256948495,2.916564521563868,1.1397412365898143,-0.4859007675345577,2.939297697422192,1.5393534107508424,1.8131035925266117,0.7860520550727967,3.3182197915652916,4.14913778551064,3.6062697345367996,0.8084219979583356,4.42486628438319,3.390608487752808,-1.6539120491319448,3.8971314850527383,-0.8400556791667695,0.775589011269056,4.728252101669532,3.999479358763021,1.6644556535291253,1.2342642224266553,3.446742257988004,-0.4097934417336253,3.5637733005901664,2.299213778231617,4.145961753655331,2.598603788986998,0.8651646392377605,3.188511650522199,2.1947940645644914,0.2661975688483613,0.730036981317423,1.0124786686781588,2.9145351538399327,4.202270229636732,2.773169206581195,0.6543339059973787,2.13771527029522,3.8448145346669564,4.763702128131803,1.1318502839109241,3.3349888054201946,2.1219191211023043,-1.0529280070927145,0.49406523882872033,1.8052987358859847,1.8926194084055714,2.1119150324157028,1.737844545113382,3.485803190175507,1.0982747201805028,-0.0470381143201557],"y":[1.393063450662071,1.8683264502831296,2.375911035896644,2.5705565715812533,2.480923651947025,2.060218248685585,1.495911515897582,2.100846637877444,5.486045632205563,1.9059385755525913,3.9677709986671292,1.613489877214887,3.5951509891345967,3.5619649476515125,2.8062097474814873,1.6363894606522127,1.5533179878043644,3.3879247151362737,1.4792633063533902,0.876404650182474,3.630713479251975,3.5214073358080356,2.3924003658571085,2.696700684367798,2.5756942724490095,2.790055424967436,2.0908803720690763,0.9937851792248047,1.5654756038457354,2.904957432278687,0.861006043308068,1.2207599413354568,2.715764856623034,3.8869730940243574,2.6729576971903573,2.5386903708639856,4.4477557391976585,1.6487243319035318,2.0341774720660784,3.1472272466618954,3.359382063186567,2.948615696267284,0.13860420610337698,3.2362688571226332,3.13392835730985,3.113362559987298,2.965249953535894,3.835131252494742,2.510088673224624,1.9823465636965523,0.539726379460765,2.109794595497851,2.139782213182384,2.1417338145156446,1.459063917082327,2.4408758922712472,3.463131482267203,2.9410272100548536,1.2341296138956714,3.0741299485494036,2.5068499815651446,0.5984481982534025,2.899700756818474,0.27644970632409205,1.2152138297478619,3.701826110150874,3.186923955633036,1.6228280184042863,1.270182685450818,2.5508895095092736,0.8803724816378047,2.660323096635855,1.980008863312145,3.080568638159166,2.127775755543418,1.1027831918034998,2.172576728854949,1.8167246725185535,0.9177401220665597,1.4417928878292763,1.5311111337075598,2.207411016693051,3.4308905993162764,2.023642734666465,1.6164734016530833,1.719834506485098,2.823497280952788,3.631395313031174,1.826747225557673,2.4121899014664407,2.0838215951594243,0.13706652759009508,1.1864567918042983,2.0304404615247638,1.78193976117044,2.5015900907183823,2.0190170283794213,2.9490205755063457,1.3808413169593923,0.9382562839234225],"type":"scatter"},{"marker":{"color":"rgba(21, 96, 130, 0.7)","size":12,"symbol":"circle"},"mode":"markers","showlegend":false,"x":[-2.435257509594034],"y":[-2.2555973138035217],"type":"scatter"},{"marker":{"color":"rgba(233, 113, 50, 0.7)","size":12,"symbol":"square"},"mode":"markers","showlegend":false,"x":[2.435257509594025],"y":[2.2555973138035146],"type":"scatter"},{"line":{"color":"#A02B93","dash":"dash","width":2},"mode":"lines","name":"LR probe","x":[-6.158409855679303,-6.033997535362549,-5.909585215045796,-5.785172894729043,-5.660760574412289,-5.536348254095535,-5.411935933778782,-5.287523613462028,-5.163111293145274,-5.03869897282852,-4.914286652511767,-4.789874332195014,-4.66546201187826,-4.541049691561506,-4.416637371244753,-4.292225050928,-4.167812730611245,-4.043400410294492,-3.9189880899777383,-3.7945757696609848,-3.6701634493442308,-3.5457511290274772,-3.421338808710724,-3.2969264883939697,-3.1725141680772166,-3.048101847760463,-2.923689527443709,-2.7992772071269556,-2.674864886810202,-2.550452566493449,-2.426040246176695,-2.3016279258599415,-2.1772156055431875,-2.052803285226434,-1.9283909649096802,-1.8039786445929265,-1.6795663242761736,-1.5551540039594198,-1.430741683642666,-1.3063293633259123,-1.1819170430091586,-1.0575047226924048,-0.9330924023756518,-0.8086800820588982,-0.6842677617421444,-0.5598554414253907,-0.435443121108637,-0.3110308007918833,-0.18661848047513024,-0.06220616015837652,0.062206160158377204,0.1866184804751316,0.3110308007918846,0.43544312110863764,0.5598554414253921,0.6842677617421451,0.8086800820588995,0.9330924023756525,1.0575047226924055,1.18191704300916,1.306329363325913,1.4307416836426674,1.5551540039594205,1.679566324276175,1.8039786445929278,1.9283909649096809,2.0528032852264353,2.1772156055431884,2.301627925859943,2.426040246176696,2.5504525664934503,2.6748648868102034,2.799277207126956,2.9236895274437105,3.0481018477604636,3.172514168077218,3.296926488393971,3.421338808710724,3.5457511290274786,3.6701634493442317,3.794575769660986,3.918988089977739,4.043400410294494,4.167812730611247,4.292225050928,4.416637371244754,4.541049691561507,4.665462011878262,4.789874332195015,4.914286652511769,5.038698972828522,5.163111293145275,5.287523613462029,5.411935933778782,5.536348254095537,5.66076057441229,5.785172894729043,5.909585215045797,6.03399753536255,6.158409855679303],"y":[-1.1378160797126338,-1.1148298962840957,-1.0918437128555576,-1.0688575294270197,-1.0458713459984816,-1.0228851625699436,-0.9998989791414055,-0.9769127957128674,-0.9539266122843293,-0.9309404288557912,-0.9079542454272532,-0.8849680619987151,-0.861981878570177,-0.838995695141639,-0.8160095117131009,-0.793023328284563,-0.7700371448560248,-0.7470509614274868,-0.7240647779989487,-0.7010785945704107,-0.6780924111418726,-0.6551062277133345,-0.6321200442847965,-0.6091338608562583,-0.5861476774277204,-0.5631614939991824,-0.5401753105706443,-0.5171891271421062,-0.4942029437135681,-0.4712167602850301,-0.4482305768564921,-0.425244393427954,-0.4022582099994159,-0.37927202657087783,-0.35628584314233974,-0.33329965971380165,-0.31031347628526373,-0.28732729285672565,-0.26434110942818756,-0.2413549259996495,-0.2183687425711114,-0.19538255914257335,-0.1723963757140354,-0.14941019228549732,-0.12642400885695923,-0.10343782542842116,-0.08045164199988308,-0.057465458571345,-0.034479275142807055,-0.011493091714268976,0.011493091714269103,0.034479275142807304,0.05746545857134526,0.08045164199988321,0.1034378254284214,0.12642400885695937,0.14941019228549757,0.17239637571403552,0.19538255914257346,0.21836874257111166,0.24135492599964964,0.26434110942818784,0.28732729285672576,0.310313476285264,0.33329965971380193,0.3562858431423399,0.3792720265708781,0.402258209999416,0.4252443934279542,0.4482305768564922,0.4712167602850304,0.4942029437135684,0.5171891271421063,0.5401753105706445,0.5631614939991825,0.5861476774277207,0.6091338608562586,0.6321200442847965,0.6551062277133348,0.6780924111418727,0.7010785945704109,0.7240647779989489,0.7470509614274871,0.770037144856025,0.793023328284563,0.8160095117131012,0.8389956951416392,0.8619818785701774,0.8849680619987152,0.9079542454272534,0.9309404288557914,0.9539266122843294,0.9769127957128676,0.9998989791414056,1.0228851625699438,1.0458713459984816,1.0688575294270197,1.0918437128555578,1.114829896284096,1.1378160797126338],"type":"scatter"},{"line":{"color":"#4EA72E","dash":"dash","width":2},"mode":"lines","name":"MM probe","x":[4.511194627607036,4.420059382604874,4.328924137602711,4.237788892600549,4.146653647598387,4.055518402596225,3.964383157594062,3.8732479125919,3.7821126675897374,3.690977422587575,3.599842177585413,3.5087069325832503,3.417571687581088,3.3264364425789257,3.235301197576763,3.144165952574601,3.053030707572438,2.9618954625702765,2.870760217568114,2.7796249725659514,2.688489727563789,2.597354482561627,2.5062192375594647,2.4150839925573018,2.3239487475551397,2.2328135025529776,2.141678257550815,2.0505430125486526,1.95940776754649,1.8682725225443282,1.7771372775421657,1.6860020325400034,1.5948667875378408,1.5037315425356783,1.412596297533516,1.3214610525313535,1.2303258075291916,1.139190562527029,1.0480553175248668,0.9569200725227043,0.8657848275205419,0.7746495825183795,0.6835143375162175,0.5923790925140551,0.5012438475118927,0.4101086025097302,0.3189733575075678,0.22783811250540534,0.1367028675032434,0.04556762250108097,-0.04556762250108147,-0.1367028675032444,-0.22783811250540634,-0.3189733575075683,-0.4101086025097312,-0.5012438475118931,-0.5923790925140561,-0.683514337516218,-0.7746495825183799,-0.8657848275205429,-0.9569200725227048,-1.0480553175248677,-1.1391905625270298,-1.2303258075291925,-1.3214610525313546,-1.4125962975335165,-1.5037315425356794,-1.5948667875378413,-1.6860020325400042,-1.7771372775421663,-1.868272522544329,-1.9594077675464912,-2.050543012548653,-2.141678257550816,-2.232813502552978,-2.323948747555141,-2.4150839925573027,-2.5062192375594647,-2.5973544825616277,-2.68848972756379,-2.7796249725659523,-2.8707602175681144,-2.9618954625702774,-3.0530307075724394,-3.144165952574601,-3.235301197576764,-3.326436442578926,-3.417571687581089,-3.508706932583251,-3.599842177585414,-3.6909774225875758,-3.782112667589738,-3.873247912591901,-3.9643831575940625,-4.055518402596226,-4.146653647598388,-4.237788892600549,-4.328924137602712,-4.420059382604874,-4.511194627607036],"y":[-4.870515019188059,-4.7721207763761795,-4.673726533564299,-4.57533229075242,-4.476938047940539,-4.378543805128659,-4.28014956231678,-4.181755319504899,-4.083361076693019,-3.9849668338811393,-3.8865725910692595,-3.7881783482573796,-3.6897841054454994,-3.591389862633619,-3.4929956198217393,-3.3946013770098595,-3.2962071341979793,-3.1978128913860995,-3.0994186485742197,-3.0010244057623394,-2.902630162950459,-2.8042359201385794,-2.7058416773266996,-2.6074474345148193,-2.5090531917029395,-2.4106589488910597,-2.3122647060791794,-2.213870463267299,-2.1154762204554194,-2.0170819776435396,-1.9186877348316596,-1.8202934920197795,-1.7218992492078995,-1.6235050063960195,-1.5251107635841392,-1.4267165207722592,-1.3283222779603796,-1.2299280351484996,-1.1315337923366195,-1.0331395495247395,-0.9347453067128594,-0.8363510639009794,-0.7379568210890998,-0.6395625782772197,-0.5411683354653396,-0.4427740926534595,-0.3443798498415795,-0.24598560702969938,-0.14759136421781985,-0.04919712140593977,0.04919712140594031,0.14759136421782093,0.24598560702970046,0.34437984984158,0.4427740926534606,0.5411683354653402,0.6395625782772207,0.7379568210891003,0.8363510639009799,0.9347453067128605,1.03313954952474,1.1315337923366207,1.2299280351485002,1.3283222779603807,1.4267165207722603,1.5251107635841399,1.6235050063960206,1.7218992492079,1.8202934920197806,1.9186877348316602,2.017081977643541,2.1154762204554203,2.2138704632673,2.3122647060791803,2.41065894889106,2.509053191702941,2.60744743451482,2.7058416773266996,2.8042359201385803,2.90263016295046,3.0010244057623403,3.09941864857422,3.197812891386101,3.29620713419798,3.3946013770098595,3.4929956198217402,3.59138986263362,3.6897841054455007,3.78817834825738,3.886572591069261,3.98496683388114,4.08336107669302,4.181755319504901,4.28014956231678,4.37854380512866,4.47693804794054,4.57533229075242,4.673726533564301,4.7721207763761795,4.870515019188059],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"xaxis":{"title":{"text":"# of assignments turned in"},"scaleanchor":"y","scaleratio":1},"yaxis":{"title":{"text":"average grade"},"scaleanchor":"x","scaleratio":1},"width":500,"height":400,"annotations":[{"arrowcolor":"#A02B93","arrowhead":4,"arrowsize":2,"arrowwidth":1,"ax":-2.435257509594034,"axref":"x","ay":-2.0555973138035215,"ayref":"y","showarrow":true,"x":-3.004165549450351,"xref":"x","y":0.62360761403613,"yref":"y"}]},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('d7e6e070-8607-4a77-be56-e33e7c40988f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">mean_low</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  <span class="c1"># x-coordinate of the arrow&#39;s head</span>
    <span class="n">ay</span><span class="o">=</span><span class="n">mean_low</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.2</span><span class="p">,</span>  <span class="c1"># y-coordinate of the arrow&#39;s head</span>
    <span class="n">x</span><span class="o">=</span><span class="n">mean_high</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="c1"># x-coordinate of the arrow&#39;s tail</span>
    <span class="n">y</span><span class="o">=</span><span class="n">mean_high</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.2</span><span class="p">,</span> <span class="c1"># y-coordinate of the arrow&#39;s tail</span>
    <span class="n">xref</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">yref</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="c1"># Reference coordinates to the plot&#39;s x and y axes</span>
    <span class="n">axref</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">ayref</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>
    <span class="n">showarrow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">arrowhead</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="c1"># Style of the arrowhead (e.g., 1, 2, 3, 4, 5)</span>
    <span class="n">arrowsize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">arrowwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">arrowcolor</span><span class="o">=</span><span class="n">COLORS</span><span class="o">.</span><span class="n">GREEN</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="a6386541-b682-461a-9dc1-640a6e1d27de" class="plotly-graph-div" style="height:400px; width:500px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("a6386541-b682-461a-9dc1-640a6e1d27de")) {                    Plotly.newPlot(                        "a6386541-b682-461a-9dc1-640a6e1d27de",                        [{"marker":{"color":"rgba(70, 177, 225, 0.5)","size":10,"symbol":"circle"},"mode":"markers","name":"failed final","x":[-1.324129517162433,-3.4020705968353964,-1.739112919801535,-5.2368281551133915,-0.8198469127358345,-4.938002426218874,-2.1662752732063044,-2.3919138201255397,-3.6280713952757075,2.993770897135655,-3.2515852687758144,-1.3250814254800316,-0.2027830014289842,-4.362807855810381,0.24073745474397246,-2.3953736316473764,-0.352976155285484,-3.8204684779149582,-4.028658387118494,0.002129595492641023,-1.2721338670421352,-1.9255808949631747,-1.0221340098293856,-1.226305216645204,-4.253352437234434,-6.1595042767586765,-5.202665732555625,-5.39407366575628,-6.168866914900917,-3.340879418142472,-3.1266317913102464,-2.2460805285361385,-1.7885473066960431,-2.8673498584407016,-2.6325313544097897,-2.0436502795573004,-3.970470921208813,-3.460445331536479,-2.111754590791528,-3.3958056710652613,-3.2048899247001135,-2.366056181442598,0.22899239576478791,-1.601906495415351,-2.7831754639344606,-3.228986914257728,-2.382359907265953,1.859768016067025,-7.84085375262356,-1.2122594059401859,-1.7570212229536226,-0.6138025022562852,-4.242286899487684,1.6303156207755238,-0.3738070446032866,-2.268051005359405,-1.8878861573123489,-3.4647784692293233,-2.0845629260987293,-2.4335113600325142,-0.47706831090694024,-1.5317444079996543,-2.3257125789284006,-0.9554530285905196,-1.1745953407628242,-1.774608984309908,-4.92767787692107,-0.32292389785658404,-4.27476978086262,-3.992714988001323,-2.3649863935001783,-1.2538641292037047,0.3584059608525809,-5.213357409729115,0.4727171728980073,0.7701292195534393,-3.0060148990384397,-2.5379561001260935,-3.204774128352668,-3.261442420379977,-4.58640461181945,-5.2168792704813,-2.5342932245378362,-1.7115133600072907,1.1163732732903933,-3.9773067948700245,-5.940548197867221,-1.9116965432016553,-3.0149359972169165,-1.5343026006916007,-2.8916875333798453,-4.442106341941019,-3.4154856602460573,-0.7307692033990456,-1.6852001406769972,-3.92002171141843,-0.6059613942788014,-4.778951010877936,-3.141170288886949,-1.8192470844787776],"y":[-1.5084909726111597,-2.885229472594647,-1.631001581692166,-3.8674186057986164,-1.0157654879649325,-3.8393068555221905,-2.4426419012909513,-1.9857959480687004,-2.2790233921274066,0.25930724605371047,-2.153523888640221,-1.2047246772944433,-0.8630998399945362,-3.2452532144986215,-1.5335322455566782,-2.666550356413116,-1.418072174073636,-2.7587687249631827,-3.0710651676784257,-1.196879180392946,-1.6096918979921249,-2.459001050787302,-1.395715947317223,-1.8988375360361234,-2.7444015396622152,-4.033279343994228,-3.829555292496064,-3.8568259575951718,-4.566504945659663,-2.619626073075093,-2.865231779425944,-2.1563430932234464,-1.5509450672538403,-2.3309572140382855,-2.1722943568002613,-1.2287943337206801,-2.776586206740804,-2.395535013811024,-2.1318656088884955,-3.055371239330766,-2.533763872147258,-2.530751179752416,-1.7889614482693847,-1.6214454358410588,-2.2908528444155003,-2.9350209041315782,-1.8030283977456785,-0.09445542501861048,-5.0620970321170455,-1.893927080500207,-1.5309987131544265,-1.4390440850980415,-3.2727196744402267,-0.3260231811852883,-1.42301495964338,-2.640644100642529,-2.1649749741049407,-2.997367694085753,-1.832649093875018,-2.610773611343885,-1.0324505675192714,-1.921450008215868,-2.4070647332231196,-1.529599426123223,-1.5762300635581905,-1.8556060549730606,-3.2897335766438864,-1.0970318819767133,-3.602962219616967,-3.2030350879500755,-1.693793490930915,-1.6618147439415898,-1.5240545586121925,-3.5551845430085978,-0.25233502132285146,-0.2629487648150448,-2.4850890976993627,-2.202296834430358,-2.407397655509487,-2.6768825523533817,-3.438531626232626,-3.1174859700844433,-2.3861972765646113,-1.551631721725455,-0.9137518866562893,-3.223833404975821,-4.315891363331693,-1.8313677039603302,-2.696114700680152,-1.961091839488776,-2.7220444303148037,-3.1767871254237567,-2.413772221647964,-1.5439941531598738,-1.6591533699206398,-2.9642748220717454,-1.48813159585589,-3.2841754033728003,-2.168020752137963,-2.6898054838385015],"type":"scatter"},{"marker":{"color":"rgba(242, 170, 132, 0.5)","size":10,"symbol":"square"},"mode":"markers","name":"passed final","x":[0.3663443210899322,0.6744960970462222,2.8531781629248476,2.6804177538958625,2.3730511024749026,1.8072387769761127,0.8396864948523932,1.4163875927116658,8.29953115762547,1.697549788273217,5.535117629307096,1.767291029510516,5.283031231445714,5.042176759063158,3.636096606417536,1.6699583142585004,0.3448231261601764,4.5628394124216625,0.51328975850672,0.5302662053924552,5.565611158123546,5.4558843623984865,2.892276719914995,2.381341027350035,1.6287603535141555,3.456899954425105,1.953239408088689,0.10093891834520896,1.4501411090986425,3.27306176334693,-0.03715950744689156,1.0613493259592728,3.045466917917314,5.865221754960095,3.1444457435489257,2.882106823134497,6.304284002009429,0.9127255055790835,1.5057636081199197,4.341430493818934,4.762627963621312,3.648338954602969,-1.8905919943636365,4.154779402364565,4.025997890128768,2.9080207311089685,4.023435659858433,5.358803256948495,2.916564521563868,1.1397412365898143,-0.4859007675345577,2.939297697422192,1.5393534107508424,1.8131035925266117,0.7860520550727967,3.3182197915652916,4.14913778551064,3.6062697345367996,0.8084219979583356,4.42486628438319,3.390608487752808,-1.6539120491319448,3.8971314850527383,-0.8400556791667695,0.775589011269056,4.728252101669532,3.999479358763021,1.6644556535291253,1.2342642224266553,3.446742257988004,-0.4097934417336253,3.5637733005901664,2.299213778231617,4.145961753655331,2.598603788986998,0.8651646392377605,3.188511650522199,2.1947940645644914,0.2661975688483613,0.730036981317423,1.0124786686781588,2.9145351538399327,4.202270229636732,2.773169206581195,0.6543339059973787,2.13771527029522,3.8448145346669564,4.763702128131803,1.1318502839109241,3.3349888054201946,2.1219191211023043,-1.0529280070927145,0.49406523882872033,1.8052987358859847,1.8926194084055714,2.1119150324157028,1.737844545113382,3.485803190175507,1.0982747201805028,-0.0470381143201557],"y":[1.393063450662071,1.8683264502831296,2.375911035896644,2.5705565715812533,2.480923651947025,2.060218248685585,1.495911515897582,2.100846637877444,5.486045632205563,1.9059385755525913,3.9677709986671292,1.613489877214887,3.5951509891345967,3.5619649476515125,2.8062097474814873,1.6363894606522127,1.5533179878043644,3.3879247151362737,1.4792633063533902,0.876404650182474,3.630713479251975,3.5214073358080356,2.3924003658571085,2.696700684367798,2.5756942724490095,2.790055424967436,2.0908803720690763,0.9937851792248047,1.5654756038457354,2.904957432278687,0.861006043308068,1.2207599413354568,2.715764856623034,3.8869730940243574,2.6729576971903573,2.5386903708639856,4.4477557391976585,1.6487243319035318,2.0341774720660784,3.1472272466618954,3.359382063186567,2.948615696267284,0.13860420610337698,3.2362688571226332,3.13392835730985,3.113362559987298,2.965249953535894,3.835131252494742,2.510088673224624,1.9823465636965523,0.539726379460765,2.109794595497851,2.139782213182384,2.1417338145156446,1.459063917082327,2.4408758922712472,3.463131482267203,2.9410272100548536,1.2341296138956714,3.0741299485494036,2.5068499815651446,0.5984481982534025,2.899700756818474,0.27644970632409205,1.2152138297478619,3.701826110150874,3.186923955633036,1.6228280184042863,1.270182685450818,2.5508895095092736,0.8803724816378047,2.660323096635855,1.980008863312145,3.080568638159166,2.127775755543418,1.1027831918034998,2.172576728854949,1.8167246725185535,0.9177401220665597,1.4417928878292763,1.5311111337075598,2.207411016693051,3.4308905993162764,2.023642734666465,1.6164734016530833,1.719834506485098,2.823497280952788,3.631395313031174,1.826747225557673,2.4121899014664407,2.0838215951594243,0.13706652759009508,1.1864567918042983,2.0304404615247638,1.78193976117044,2.5015900907183823,2.0190170283794213,2.9490205755063457,1.3808413169593923,0.9382562839234225],"type":"scatter"},{"marker":{"color":"rgba(21, 96, 130, 0.7)","size":12,"symbol":"circle"},"mode":"markers","showlegend":false,"x":[-2.435257509594034],"y":[-2.2555973138035217],"type":"scatter"},{"marker":{"color":"rgba(233, 113, 50, 0.7)","size":12,"symbol":"square"},"mode":"markers","showlegend":false,"x":[2.435257509594025],"y":[2.2555973138035146],"type":"scatter"},{"line":{"color":"#A02B93","dash":"dash","width":2},"mode":"lines","name":"LR probe","x":[-6.158409855679303,-6.033997535362549,-5.909585215045796,-5.785172894729043,-5.660760574412289,-5.536348254095535,-5.411935933778782,-5.287523613462028,-5.163111293145274,-5.03869897282852,-4.914286652511767,-4.789874332195014,-4.66546201187826,-4.541049691561506,-4.416637371244753,-4.292225050928,-4.167812730611245,-4.043400410294492,-3.9189880899777383,-3.7945757696609848,-3.6701634493442308,-3.5457511290274772,-3.421338808710724,-3.2969264883939697,-3.1725141680772166,-3.048101847760463,-2.923689527443709,-2.7992772071269556,-2.674864886810202,-2.550452566493449,-2.426040246176695,-2.3016279258599415,-2.1772156055431875,-2.052803285226434,-1.9283909649096802,-1.8039786445929265,-1.6795663242761736,-1.5551540039594198,-1.430741683642666,-1.3063293633259123,-1.1819170430091586,-1.0575047226924048,-0.9330924023756518,-0.8086800820588982,-0.6842677617421444,-0.5598554414253907,-0.435443121108637,-0.3110308007918833,-0.18661848047513024,-0.06220616015837652,0.062206160158377204,0.1866184804751316,0.3110308007918846,0.43544312110863764,0.5598554414253921,0.6842677617421451,0.8086800820588995,0.9330924023756525,1.0575047226924055,1.18191704300916,1.306329363325913,1.4307416836426674,1.5551540039594205,1.679566324276175,1.8039786445929278,1.9283909649096809,2.0528032852264353,2.1772156055431884,2.301627925859943,2.426040246176696,2.5504525664934503,2.6748648868102034,2.799277207126956,2.9236895274437105,3.0481018477604636,3.172514168077218,3.296926488393971,3.421338808710724,3.5457511290274786,3.6701634493442317,3.794575769660986,3.918988089977739,4.043400410294494,4.167812730611247,4.292225050928,4.416637371244754,4.541049691561507,4.665462011878262,4.789874332195015,4.914286652511769,5.038698972828522,5.163111293145275,5.287523613462029,5.411935933778782,5.536348254095537,5.66076057441229,5.785172894729043,5.909585215045797,6.03399753536255,6.158409855679303],"y":[-1.1378160797126338,-1.1148298962840957,-1.0918437128555576,-1.0688575294270197,-1.0458713459984816,-1.0228851625699436,-0.9998989791414055,-0.9769127957128674,-0.9539266122843293,-0.9309404288557912,-0.9079542454272532,-0.8849680619987151,-0.861981878570177,-0.838995695141639,-0.8160095117131009,-0.793023328284563,-0.7700371448560248,-0.7470509614274868,-0.7240647779989487,-0.7010785945704107,-0.6780924111418726,-0.6551062277133345,-0.6321200442847965,-0.6091338608562583,-0.5861476774277204,-0.5631614939991824,-0.5401753105706443,-0.5171891271421062,-0.4942029437135681,-0.4712167602850301,-0.4482305768564921,-0.425244393427954,-0.4022582099994159,-0.37927202657087783,-0.35628584314233974,-0.33329965971380165,-0.31031347628526373,-0.28732729285672565,-0.26434110942818756,-0.2413549259996495,-0.2183687425711114,-0.19538255914257335,-0.1723963757140354,-0.14941019228549732,-0.12642400885695923,-0.10343782542842116,-0.08045164199988308,-0.057465458571345,-0.034479275142807055,-0.011493091714268976,0.011493091714269103,0.034479275142807304,0.05746545857134526,0.08045164199988321,0.1034378254284214,0.12642400885695937,0.14941019228549757,0.17239637571403552,0.19538255914257346,0.21836874257111166,0.24135492599964964,0.26434110942818784,0.28732729285672576,0.310313476285264,0.33329965971380193,0.3562858431423399,0.3792720265708781,0.402258209999416,0.4252443934279542,0.4482305768564922,0.4712167602850304,0.4942029437135684,0.5171891271421063,0.5401753105706445,0.5631614939991825,0.5861476774277207,0.6091338608562586,0.6321200442847965,0.6551062277133348,0.6780924111418727,0.7010785945704109,0.7240647779989489,0.7470509614274871,0.770037144856025,0.793023328284563,0.8160095117131012,0.8389956951416392,0.8619818785701774,0.8849680619987152,0.9079542454272534,0.9309404288557914,0.9539266122843294,0.9769127957128676,0.9998989791414056,1.0228851625699438,1.0458713459984816,1.0688575294270197,1.0918437128555578,1.114829896284096,1.1378160797126338],"type":"scatter"},{"line":{"color":"#4EA72E","dash":"dash","width":2},"mode":"lines","name":"MM probe","x":[4.511194627607036,4.420059382604874,4.328924137602711,4.237788892600549,4.146653647598387,4.055518402596225,3.964383157594062,3.8732479125919,3.7821126675897374,3.690977422587575,3.599842177585413,3.5087069325832503,3.417571687581088,3.3264364425789257,3.235301197576763,3.144165952574601,3.053030707572438,2.9618954625702765,2.870760217568114,2.7796249725659514,2.688489727563789,2.597354482561627,2.5062192375594647,2.4150839925573018,2.3239487475551397,2.2328135025529776,2.141678257550815,2.0505430125486526,1.95940776754649,1.8682725225443282,1.7771372775421657,1.6860020325400034,1.5948667875378408,1.5037315425356783,1.412596297533516,1.3214610525313535,1.2303258075291916,1.139190562527029,1.0480553175248668,0.9569200725227043,0.8657848275205419,0.7746495825183795,0.6835143375162175,0.5923790925140551,0.5012438475118927,0.4101086025097302,0.3189733575075678,0.22783811250540534,0.1367028675032434,0.04556762250108097,-0.04556762250108147,-0.1367028675032444,-0.22783811250540634,-0.3189733575075683,-0.4101086025097312,-0.5012438475118931,-0.5923790925140561,-0.683514337516218,-0.7746495825183799,-0.8657848275205429,-0.9569200725227048,-1.0480553175248677,-1.1391905625270298,-1.2303258075291925,-1.3214610525313546,-1.4125962975335165,-1.5037315425356794,-1.5948667875378413,-1.6860020325400042,-1.7771372775421663,-1.868272522544329,-1.9594077675464912,-2.050543012548653,-2.141678257550816,-2.232813502552978,-2.323948747555141,-2.4150839925573027,-2.5062192375594647,-2.5973544825616277,-2.68848972756379,-2.7796249725659523,-2.8707602175681144,-2.9618954625702774,-3.0530307075724394,-3.144165952574601,-3.235301197576764,-3.326436442578926,-3.417571687581089,-3.508706932583251,-3.599842177585414,-3.6909774225875758,-3.782112667589738,-3.873247912591901,-3.9643831575940625,-4.055518402596226,-4.146653647598388,-4.237788892600549,-4.328924137602712,-4.420059382604874,-4.511194627607036],"y":[-4.870515019188059,-4.7721207763761795,-4.673726533564299,-4.57533229075242,-4.476938047940539,-4.378543805128659,-4.28014956231678,-4.181755319504899,-4.083361076693019,-3.9849668338811393,-3.8865725910692595,-3.7881783482573796,-3.6897841054454994,-3.591389862633619,-3.4929956198217393,-3.3946013770098595,-3.2962071341979793,-3.1978128913860995,-3.0994186485742197,-3.0010244057623394,-2.902630162950459,-2.8042359201385794,-2.7058416773266996,-2.6074474345148193,-2.5090531917029395,-2.4106589488910597,-2.3122647060791794,-2.213870463267299,-2.1154762204554194,-2.0170819776435396,-1.9186877348316596,-1.8202934920197795,-1.7218992492078995,-1.6235050063960195,-1.5251107635841392,-1.4267165207722592,-1.3283222779603796,-1.2299280351484996,-1.1315337923366195,-1.0331395495247395,-0.9347453067128594,-0.8363510639009794,-0.7379568210890998,-0.6395625782772197,-0.5411683354653396,-0.4427740926534595,-0.3443798498415795,-0.24598560702969938,-0.14759136421781985,-0.04919712140593977,0.04919712140594031,0.14759136421782093,0.24598560702970046,0.34437984984158,0.4427740926534606,0.5411683354653402,0.6395625782772207,0.7379568210891003,0.8363510639009799,0.9347453067128605,1.03313954952474,1.1315337923366207,1.2299280351485002,1.3283222779603807,1.4267165207722603,1.5251107635841399,1.6235050063960206,1.7218992492079,1.8202934920197806,1.9186877348316602,2.017081977643541,2.1154762204554203,2.2138704632673,2.3122647060791803,2.41065894889106,2.509053191702941,2.60744743451482,2.7058416773266996,2.8042359201385803,2.90263016295046,3.0010244057623403,3.09941864857422,3.197812891386101,3.29620713419798,3.3946013770098595,3.4929956198217402,3.59138986263362,3.6897841054455007,3.78817834825738,3.886572591069261,3.98496683388114,4.08336107669302,4.181755319504901,4.28014956231678,4.37854380512866,4.47693804794054,4.57533229075242,4.673726533564301,4.7721207763761795,4.870515019188059],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"xaxis":{"title":{"text":"# of assignments turned in"},"scaleanchor":"y","scaleratio":1},"yaxis":{"title":{"text":"average grade"},"scaleanchor":"x","scaleratio":1},"width":500,"height":400,"annotations":[{"arrowcolor":"#A02B93","arrowhead":4,"arrowsize":2,"arrowwidth":1,"ax":-2.435257509594034,"axref":"x","ay":-2.0555973138035215,"ayref":"y","showarrow":true,"x":-3.004165549450351,"xref":"x","y":0.62360761403613,"yref":"y"},{"arrowcolor":"#4EA72E","arrowhead":4,"arrowsize":2,"arrowwidth":1,"ax":-2.435257509594034,"axref":"x","ay":-2.0555973138035215,"ayref":"y","showarrow":true,"x":2.435257509594025,"xref":"x","y":2.0555973138035144,"yref":"y"}]},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('a6386541-b682-461a-9dc1-640a6e1d27de');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div>
</div>
<p>The mean mass probe suggests a better intervention - not only should students’ grades go up, but they should also probably turn in more assignments in order to prepare for the final.</p>
<p>Even here, causality isn’t guaranteed. For example, there might be other underlying causes behind why students couldn’t turn in assignments. We are limited by the information in our dataset and the complexity of our intervention.</p>
<p>However, unlike with Prof. X who has to wait a whole year to try out ways to improve his students’ final grades, we get to test our interventions on our LLMs right away! Let’s see what it looks like to construct a “truth” steering vector on our LLM and use it to change a model’s opinion about the truth of a sentence.</p>
</section>
</section>
<section id="4️⃣-Difference-in-means-steering">
<h2>4️⃣ Difference in means steering<a class="headerlink" href="#4️⃣-Difference-in-means-steering" title="Link to this heading">#</a></h2>
<p>Now that we’ve explored the effect of different probe methods, let’s return to our investigation of how LMs represent truth.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">true_activations_mean</span> <span class="o">=</span> <span class="n">true_activations</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">false_activations_mean</span> <span class="o">=</span> <span class="n">false_activations</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">difference_in_means</span> <span class="o">=</span> <span class="n">true_activations_mean</span> <span class="o">-</span> <span class="n">false_activations_mean</span>
<span class="n">difference_in_means</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
torch.Size([3072])
</pre></div></div>
</div>
<p>Steer from false to true</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">base_prompt</span><span class="p">)</span> <span class="k">as</span> <span class="n">trace</span><span class="p">:</span>
    <span class="n">logits</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">logits</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">base_prompt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">logits</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The city of Chicago is in Canada. This statement is:
 FALSE
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">base_prompt_token_ids</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">(</span><span class="n">base_prompt</span><span class="p">)</span><span class="o">.</span><span class="n">input_ids</span>
<span class="n">punctuation_token_id</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">punctuation_index</span> <span class="o">=</span> <span class="n">rindex</span><span class="p">(</span><span class="n">base_prompt_token_ids</span><span class="p">,</span> <span class="n">punctuation_token_id</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">base_prompt</span><span class="p">)</span> <span class="k">as</span> <span class="n">trace</span><span class="p">:</span>
    <span class="c1"># steer model!</span>
    <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">LAYER</span><span class="p">]</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="n">punctuation_index</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">difference_in_means</span>

    <span class="n">logits</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">logits</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">base_prompt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">logits</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The city of Chicago is in Canada. This statement is:
 TRUE
</pre></div></div>
</div>
<p>Steer from true to false</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">source_prompt</span><span class="p">)</span> <span class="k">as</span> <span class="n">trace</span><span class="p">:</span>
    <span class="n">logits</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">logits</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">source_prompt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">logits</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The city of Toronto is in Canada. This statement is:
 TRUE
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">source_prompt_token_ids</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">(</span><span class="n">source_prompt</span><span class="p">)</span><span class="o">.</span><span class="n">input_ids</span>
<span class="n">punctuation_token_id</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">punctuation_index</span> <span class="o">=</span> <span class="n">rindex</span><span class="p">(</span><span class="n">source_prompt_token_ids</span><span class="p">,</span> <span class="n">punctuation_token_id</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">source_prompt</span><span class="p">)</span> <span class="k">as</span> <span class="n">trace</span><span class="p">:</span>
    <span class="c1"># reverse the steering direction!</span>
    <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">LAYER</span><span class="p">]</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="n">punctuation_index</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-=</span> <span class="n">difference_in_means</span>

    <span class="n">logits</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">logits</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">source_prompt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">logits</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The city of Toronto is in Canada. This statement is:
 FALSE
</pre></div></div>
</div>
</section>
<section id="➡️-Let's-scale-things-up!-Steering-Llama-70B-on-NDIF">
<h2>➡️ Let’s scale things up! Steering Llama-70B on NDIF<a class="headerlink" href="#➡️-Let's-scale-things-up!-Steering-Llama-70B-on-NDIF" title="Link to this heading">#</a></h2>
<p>If you’re using Colab, we recommend disconnecting and re-connecting to a CPU instance. In this section, we’ll use the models provided by NDIF!</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">clear_output</span>

<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">U</span> <span class="n">nnsight</span>

<span class="n">clear_output</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">nnsight</span><span class="w"> </span><span class="kn">import</span> <span class="n">CONFIG</span>

<span class="n">CONFIG</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">APIKEY</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter your API key: &quot;</span><span class="p">)</span>
<span class="n">clear_output</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">huggingface_hub</span><span class="w"> </span><span class="kn">import</span> <span class="n">notebook_login</span>

<span class="n">notebook_login</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "1101934521bf452aba9944608e01295a"}</script></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># instantiate the model using the LanguageModel class</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nnsight</span><span class="w"> </span><span class="kn">import</span> <span class="n">LanguageModel</span>

<span class="c1"># don&#39;t worry, this won&#39;t load locally!</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LanguageModel</span><span class="p">(</span><span class="s2">&quot;meta-llama/Meta-Llama-3.1-70B&quot;</span><span class="p">,</span> <span class="n">device_map</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>

<span class="n">clear_output</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(128256, 8192)
    (layers): ModuleList(
      (0-79): 80 x LlamaDecoderLayer(
        (self_attn): LlamaAttention(
          (q_proj): Linear(in_features=8192, out_features=8192, bias=False)
          (k_proj): Linear(in_features=8192, out_features=1024, bias=False)
          (v_proj): Linear(in_features=8192, out_features=1024, bias=False)
          (o_proj): Linear(in_features=8192, out_features=8192, bias=False)
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=8192, out_features=28672, bias=False)
          (up_proj): Linear(in_features=8192, out_features=28672, bias=False)
          (down_proj): Linear(in_features=28672, out_features=8192, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): LlamaRMSNorm((8192,), eps=1e-05)
        (post_attention_layernorm): LlamaRMSNorm((8192,), eps=1e-05)
      )
    )
    (norm): LlamaRMSNorm((8192,), eps=1e-05)
    (rotary_emb): LlamaRotaryEmbedding()
  )
  (lm_head): Linear(in_features=8192, out_features=128256, bias=False)
  (generator): Generator(
    (streamer): Streamer()
  )
)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">PROMPT_TEMPLATE</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;The city of Tokyo is in Japan. This statement is: TRUE</span>
<span class="s2">The city of Hanoi is in Poland. This statement is: FALSE</span>
<span class="si">{statement}</span><span class="s2"> This statement is:&quot;&quot;&quot;</span>

<span class="c1"># patching from true statement (source) -&gt; false statement (base)</span>
<span class="n">source_statement</span> <span class="o">=</span> <span class="s2">&quot;The city of Toronto is in Canada.&quot;</span> <span class="c1"># true</span>
<span class="n">source_prompt</span> <span class="o">=</span> <span class="n">PROMPT_TEMPLATE</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">statement</span><span class="o">=</span><span class="n">source_statement</span><span class="p">)</span>
<span class="n">base_statement</span> <span class="o">=</span> <span class="s2">&quot;The city of Chicago is in Canada.&quot;</span> <span class="c1"># false</span>
<span class="n">base_prompt</span> <span class="o">=</span> <span class="n">PROMPT_TEMPLATE</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">statement</span><span class="o">=</span><span class="n">base_statement</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">base_prompt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The city of Tokyo is in Japan. This statement is: TRUE
The city of Hanoi is in Poland. This statement is: FALSE
The city of Chicago is in Canada. This statement is:
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">source_prompt</span><span class="p">,</span> <span class="n">remote</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
  <span class="n">source_logits</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">logits</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">base_prompt</span><span class="p">,</span> <span class="n">remote</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
  <span class="n">base_logits</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">logits</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="n">clear_output</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SOURCE (true statement)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">source_prompt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">source_logits</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;BASE (false statement)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">base_prompt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">base_logits</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SOURCE (true statement)
The city of Toronto is in Canada. This statement is:
 TRUE
--------------------------------------------------
BASE (false statement)
The city of Chicago is in Canada. This statement is:
 FALSE
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">num_examples</span> <span class="o">=</span> <span class="mi">50</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/saprmarks/geometry-of-truth/refs/heads/main/datasets/cities.csv&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">num_examples</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
  <div id="df-c0f499bb-4ddb-4114-acce-8b88d9b31acd" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>statement</th>
      <th>label</th>
      <th>city</th>
      <th>country</th>
      <th>correct_country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>The city of Krasnodar is in Russia.</td>
      <td>1</td>
      <td>Krasnodar</td>
      <td>Russia</td>
      <td>Russia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The city of Krasnodar is in South Africa.</td>
      <td>0</td>
      <td>Krasnodar</td>
      <td>South Africa</td>
      <td>Russia</td>
    </tr>
    <tr>
      <th>2</th>
      <td>The city of Lodz is in Poland.</td>
      <td>1</td>
      <td>Lodz</td>
      <td>Poland</td>
      <td>Poland</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The city of Lodz is in the Dominican Republic.</td>
      <td>0</td>
      <td>Lodz</td>
      <td>the Dominican Republic</td>
      <td>Poland</td>
    </tr>
    <tr>
      <th>4</th>
      <td>The city of Maracay is in Venezuela.</td>
      <td>1</td>
      <td>Maracay</td>
      <td>Venezuela</td>
      <td>Venezuela</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c0f499bb-4ddb-4114-acce-8b88d9b31acd')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c0f499bb-4ddb-4114-acce-8b88d9b31acd button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c0f499bb-4ddb-4114-acce-8b88d9b31acd');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-4e43f5ef-0c84-4577-ac2e-4ac9bc1c511d">
      <button class="colab-df-quickchart" onclick="quickchart('df-4e43f5ef-0c84-4577-ac2e-4ac9bc1c511d')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-4e43f5ef-0c84-4577-ac2e-4ac9bc1c511d button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="n">PROMPT_TEMPLATE</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;The city of Tokyo is in Japan. This statement is: TRUE</span>
<span class="s2">The city of Hanoi is in Poland. This statement is: FALSE</span>
<span class="si">{statement}</span><span class="s2"> This statement is:&quot;&quot;&quot;</span>

<span class="n">LAYER</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">punctuation_token_id</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">input_ids</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># extract activation over &quot;.&quot;</span>

<span class="n">true_activations</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">false_activations</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">session</span><span class="p">(</span><span class="n">remote</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">prompt</span> <span class="o">=</span> <span class="n">PROMPT_TEMPLATE</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">statement</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="n">statement</span><span class="p">)</span>
    <span class="n">prompt_token_ids</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span><span class="o">.</span><span class="n">input_ids</span>
    <span class="n">punctuation_index</span> <span class="o">=</span> <span class="n">rindex</span><span class="p">(</span><span class="n">prompt_token_ids</span><span class="p">,</span> <span class="n">punctuation_token_id</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">prompt</span><span class="p">):</span>
      <span class="n">activation</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">LAYER</span><span class="p">]</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="n">punctuation_index</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">false_activations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">activation</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">true_activations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">activation</span><span class="p">)</span>

<span class="n">clear_output</span><span class="p">()</span>

<span class="n">true_activations</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">true_activations</span><span class="p">)</span>
<span class="n">false_activations</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">false_activations</span><span class="p">)</span>

<span class="n">true_activations</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">false_activations</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(torch.Size([25, 8192]), torch.Size([25, 8192]))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>

<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">all_activations</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">true_activations</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span> <span class="n">false_activations</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">)])</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>

<span class="n">low_dim_activations</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">all_activations</span><span class="p">)</span>
<span class="n">low_dim_activations</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(50, 2)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">plotly.graph_objects</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">go</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="n">num_per_class</span> <span class="o">=</span> <span class="n">num_examples</span> <span class="o">//</span> <span class="mi">2</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
  <span class="n">x</span><span class="o">=</span><span class="n">low_dim_activations</span><span class="p">[:</span><span class="n">num_per_class</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
  <span class="n">y</span><span class="o">=</span><span class="n">low_dim_activations</span><span class="p">[:</span><span class="n">num_per_class</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
  <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
  <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">hex_to_rgba</span><span class="p">(</span><span class="n">COLORS</span><span class="o">.</span><span class="n">LIGHT_BLUE</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
<span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
  <span class="n">x</span><span class="o">=</span><span class="n">low_dim_activations</span><span class="p">[</span><span class="n">num_per_class</span><span class="p">:,</span> <span class="mi">0</span><span class="p">],</span>
  <span class="n">y</span><span class="o">=</span><span class="n">low_dim_activations</span><span class="p">[</span><span class="n">num_per_class</span><span class="p">:,</span> <span class="mi">1</span><span class="p">],</span>
  <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
  <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">hex_to_rgba</span><span class="p">(</span><span class="n">COLORS</span><span class="o">.</span><span class="n">LIGHT_ORANGE</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
<span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
  <span class="n">template</span><span class="o">=</span><span class="s1">&#39;simple_white&#39;</span><span class="p">,</span>
  <span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
  <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
  <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;PCA 1&#39;</span><span class="p">,</span>
  <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;PCA 2&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="1676c83c-e887-4995-adc6-451fbdf228e6" class="plotly-graph-div" style="height:400px; width:400px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("1676c83c-e887-4995-adc6-451fbdf228e6")) {                    Plotly.newPlot(                        "1676c83c-e887-4995-adc6-451fbdf228e6",                        [{"marker":{"color":"rgba(70, 177, 225, 0.5)","size":10,"symbol":"square"},"mode":"markers","name":"true","x":[2.602917423859959,2.4752996450495592,1.3034439762324201,1.4782913207658606,3.132542378366553,1.8905075901737616,1.6557447250260275,3.1502356172299155,3.1095285061857108,3.292936595358129,3.2775723988456025,3.2352695421137194,2.8977859522151146,3.156424953641727,3.269241802581547,1.514572854243976,2.246551761481186,2.1033775725373616,1.4887021702401386,1.7679375283679324,3.1698862188719255,3.088598309627856,2.869904726297409,2.893207934680839,3.203134097448331],"y":[-0.5730003947244706,-2.5529863269769697,-2.1676155835460573,-2.949169677915429,1.8641455276374992,-3.0724457929097633,-2.904608598797722,2.0548053489091798,1.9543302830738187,2.035622189221768,1.7001558507205872,1.9071194158938403,2.070418295437695,2.03860529026122,2.345119107986332,-3.2624255119389804,-1.876976036327297,-2.125889805957774,-2.959968972013044,-0.7243936852498869,-0.37269418971431756,-0.4779979768831048,0.1564739746408022,0.03337996438954508,-0.46446933488955106],"type":"scatter"},{"marker":{"color":"rgba(242, 170, 132, 0.5)","size":10,"symbol":"circle"},"mode":"markers","name":"false","x":[-3.4153391167117277,-3.027711768369682,-1.6769992089034864,-2.5789665271802606,-3.2266408620822573,-2.9568353624931136,-2.1070788990297395,-3.1588268035551628,-3.0586389872148887,-2.9326452441687536,-3.172698448706172,-3.448473333862038,-2.928072220055409,-3.066685196657916,-0.1390851413343198,-3.132318657194424,-2.5427484896858497,-2.531276037005358,-2.1186902070854337,-3.4785865158478124,-3.1137406770059974,-2.989377462260628,-0.02968909566002756,-1.2724661186251567,-2.1700252207469504],"y":[-0.4151202177471724,-0.86222923930973,2.647976504504292,-0.1879709928810035,-0.7931396514860505,0.5320571849630444,2.1324834259968837,0.14697771821091163,-0.3591407654298571,0.6269752988491015,0.07259027725790787,-0.18475459215429227,0.27889855597771573,0.2256283823494535,1.3123473960971173,-0.6243148486573812,0.3623655228715921,-0.2227255120535448,0.8435261440555133,-0.3325337928968395,-0.5556664316028048,-0.2922791719271428,0.04023954734343084,2.7635012281375957,1.168774669203345],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"width":400,"height":400,"xaxis":{"title":{"text":"PCA 1"}},"yaxis":{"title":{"text":"PCA 2"}}},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('1676c83c-e887-4995-adc6-451fbdf228e6');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">true_activations_mean</span> <span class="o">=</span> <span class="n">true_activations</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">false_activations_mean</span> <span class="o">=</span> <span class="n">false_activations</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">difference_in_means</span> <span class="o">=</span> <span class="n">true_activations_mean</span> <span class="o">-</span> <span class="n">false_activations_mean</span>
<span class="n">difference_in_means</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
torch.Size([8192])
</pre></div></div>
</div>
<p>Steer from false to true</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">base_prompt</span><span class="p">,</span> <span class="n">remote</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">trace</span><span class="p">:</span>
  <span class="n">logits</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">logits</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="n">clear_output</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">base_prompt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">logits</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The city of Chicago is in Canada. This statement is:
 FALSE
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">STEER_FACTOR</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">base_prompt_token_ids</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">(</span><span class="n">base_prompt</span><span class="p">)</span><span class="o">.</span><span class="n">input_ids</span>
<span class="n">punctuation_token_id</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">punctuation_index</span> <span class="o">=</span> <span class="n">rindex</span><span class="p">(</span><span class="n">base_prompt_token_ids</span><span class="p">,</span> <span class="n">punctuation_token_id</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

<span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">base_prompt</span><span class="p">,</span> <span class="n">remote</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">trace</span><span class="p">:</span>
  <span class="c1"># steer model!</span>
  <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">LAYER</span><span class="p">]</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="n">punctuation_index</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">difference_in_means</span> <span class="o">*</span> <span class="n">STEER_FACTOR</span>

  <span class="n">logits</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">logits</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="n">clear_output</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">base_prompt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">logits</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The city of Chicago is in Canada. This statement is:
 TRUE
</pre></div></div>
</div>
<p>Steer from true to false</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">source_prompt</span><span class="p">,</span> <span class="n">remote</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">trace</span><span class="p">:</span>
  <span class="n">logits</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">logits</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="n">clear_output</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">source_prompt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">logits</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The city of Toronto is in Canada. This statement is:
 TRUE
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">source_prompt_token_ids</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">(</span><span class="n">source_prompt</span><span class="p">)</span><span class="o">.</span><span class="n">input_ids</span>
<span class="n">punctuation_token_id</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">punctuation_index</span> <span class="o">=</span> <span class="n">rindex</span><span class="p">(</span><span class="n">source_prompt_token_ids</span><span class="p">,</span> <span class="n">punctuation_token_id</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

<span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">source_prompt</span><span class="p">,</span> <span class="n">remote</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">trace</span><span class="p">:</span>
  <span class="c1"># reverse the steering direction!</span>
  <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">LAYER</span><span class="p">]</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="n">punctuation_index</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-=</span> <span class="n">difference_in_means</span> <span class="o">*</span> <span class="n">STEER_FACTOR</span>

  <span class="n">logits</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">logits</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="n">clear_output</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">source_prompt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">logits</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The city of Toronto is in Canada. This statement is:
 FALSE
</pre></div></div>
</div>
<script type="application/vnd.jupyter.widget-state+json">
{"f9a61498d0174eaf8f50a64726760f8d": {"model_module": "@jupyter-widgets/controls", "model_name": "VBoxModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_2cb73901b1dd4044835f203e138f326c", "IPY_MODEL_72309c605bba48b7a5a2cd87b90784ae", "IPY_MODEL_cac03b90f6eb41d0b7569b26608a32a6", "IPY_MODEL_37e1c5cd1f844cbfb34e57dad08e1f7b", "IPY_MODEL_7444d0374e204864a822c689f20e7a65"], "layout": "IPY_MODEL_4fab7df5acf3400a8c2dadacb18126f4"}}, "2cb73901b1dd4044835f203e138f326c": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_f627dc1ec6c1408994ae95a607941e25", "placeholder": "\u200b", "style": "IPY_MODEL_fe9ecaccafb04a4fa6f7beab1be0297b", "value": "<center> <img\nsrc=https://huggingface.co/front/assets/huggingface_logo-noborder.svg\nalt='Hugging Face'> <br> Copy a token from <a\nhref=\"https://huggingface.co/settings/tokens\" target=\"_blank\">your Hugging Face\ntokens page</a> and paste it below. <br> Immediately click login after copying\nyour token or it might be stored in plain text in this notebook file. </center>"}}, "72309c605bba48b7a5a2cd87b90784ae": {"model_module": "@jupyter-widgets/controls", "model_name": "PasswordModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "PasswordModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "PasswordView", "continuous_update": true, "description": "Token:", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_bd0728057f45475cab3252a189243559", "placeholder": "\u200b", "style": "IPY_MODEL_30df6ddaf1b143418569304d805f7852", "value": ""}}, "cac03b90f6eb41d0b7569b26608a32a6": {"model_module": "@jupyter-widgets/controls", "model_name": "CheckboxModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "CheckboxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "CheckboxView", "description": "Add token as git credential?", "description_tooltip": null, "disabled": false, "indent": true, "layout": "IPY_MODEL_be62791231cc4468beca65a23b051edf", "style": "IPY_MODEL_3483fc34e1a1447c9acd9abaddd57544", "value": true}}, "37e1c5cd1f844cbfb34e57dad08e1f7b": {"model_module": "@jupyter-widgets/controls", "model_name": "ButtonModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Login", "disabled": false, "icon": "", "layout": "IPY_MODEL_2ced0e1b0943423c86b49d751d2dfe2c", "style": "IPY_MODEL_5291675fa0fe4f369124d1092d33d640", "tooltip": ""}}, "7444d0374e204864a822c689f20e7a65": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_951d622f471c4f47aec2a14106dc418c", "placeholder": "\u200b", "style": "IPY_MODEL_77d85afc66214b5c8029ff488d2f2434", "value": "\n<b>Pro Tip:</b> If you don't already have one, you can create a dedicated\n'notebooks' token with 'write' access, that you can then easily reuse for all\nnotebooks. </center>"}}, "4fab7df5acf3400a8c2dadacb18126f4": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": "center", "align_self": null, "border": null, "bottom": null, "display": "flex", "flex": null, "flex_flow": "column", "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "50%"}}, "f627dc1ec6c1408994ae95a607941e25": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "fe9ecaccafb04a4fa6f7beab1be0297b": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "bd0728057f45475cab3252a189243559": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "30df6ddaf1b143418569304d805f7852": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "be62791231cc4468beca65a23b051edf": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3483fc34e1a1447c9acd9abaddd57544": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "2ced0e1b0943423c86b49d751d2dfe2c": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5291675fa0fe4f369124d1092d33d640": {"model_module": "@jupyter-widgets/controls", "model_name": "ButtonStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "951d622f471c4f47aec2a14106dc418c": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "77d85afc66214b5c8029ff488d2f2434": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "4f9d39efeeb04aff8a10d227dea3542c": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_49f04c8a4b304524817ad33942cdc9ec", "IPY_MODEL_63dded09a5e240319e49739bf1fcefbf", "IPY_MODEL_8dbd000b00e04f1c9d0d9194828dfb56"], "layout": "IPY_MODEL_d99cbd3176c848f0bdfb37e03da8452a"}}, "49f04c8a4b304524817ad33942cdc9ec": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_b2ed4bbb159a461a95ee80232e3ddc47", "placeholder": "\u200b", "style": "IPY_MODEL_a234baf7ac8f40dc99d7e61ce9419595", "value": "Loading\u2007checkpoint\u2007shards:\u2007100%"}}, "63dded09a5e240319e49739bf1fcefbf": {"model_module": "@jupyter-widgets/controls", "model_name": "FloatProgressModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_bca09d9ce8454a1d9cfd5d0de576f920", "max": 2, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_58d945d9908c41dd995a3bb964121ce7", "value": 2}}, "8dbd000b00e04f1c9d0d9194828dfb56": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_8b3fe2859d654d60acc2f8dc0df002b6", "placeholder": "\u200b", "style": "IPY_MODEL_274b1eedbdee4b639a4b5c52bf8ec745", "value": "\u20072/2\u2007[00:22&lt;00:00,\u200710.48s/it]"}}, "d99cbd3176c848f0bdfb37e03da8452a": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b2ed4bbb159a461a95ee80232e3ddc47": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a234baf7ac8f40dc99d7e61ce9419595": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "bca09d9ce8454a1d9cfd5d0de576f920": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "58d945d9908c41dd995a3bb964121ce7": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "8b3fe2859d654d60acc2f8dc0df002b6": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "274b1eedbdee4b639a4b5c52bf8ec745": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "1101934521bf452aba9944608e01295a": {"model_module": "@jupyter-widgets/controls", "model_name": "VBoxModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": [], "layout": "IPY_MODEL_542a858390fd4e3b9ed42e840fac9ba6"}}, "acc15292165549c0a380a8bba68df267": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_a08aa53f1c584b0295a91c8fca8ff10c", "placeholder": "\u200b", "style": "IPY_MODEL_1d164b6dd39a4a01b6f8fcddf60f7b6e", "value": "<center> <img\nsrc=https://huggingface.co/front/assets/huggingface_logo-noborder.svg\nalt='Hugging Face'> <br> Copy a token from <a\nhref=\"https://huggingface.co/settings/tokens\" target=\"_blank\">your Hugging Face\ntokens page</a> and paste it below. <br> Immediately click login after copying\nyour token or it might be stored in plain text in this notebook file. </center>"}}, "2155d063de0e46bc8627c44b79fe354c": {"model_module": "@jupyter-widgets/controls", "model_name": "PasswordModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "PasswordModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "PasswordView", "continuous_update": true, "description": "Token:", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_eae08d86d7ca42aa96c39793cea2fd3e", "placeholder": "\u200b", "style": "IPY_MODEL_5054de5a40e845bf9dead4791eca944d", "value": ""}}, "bb9f30ea2046499f9126b29cde5f43b5": {"model_module": "@jupyter-widgets/controls", "model_name": "CheckboxModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "CheckboxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "CheckboxView", "description": "Add token as git credential?", "description_tooltip": null, "disabled": false, "indent": true, "layout": "IPY_MODEL_e8e36b88a3b34e4385fb4e6fbd7eefc9", "style": "IPY_MODEL_40c0df05655a414a8d4cea371f28fafb", "value": true}}, "0a3d6855764846f79cbde6b83d92b911": {"model_module": "@jupyter-widgets/controls", "model_name": "ButtonModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Login", "disabled": false, "icon": "", "layout": "IPY_MODEL_484b5dc3b2f04749b58f4350167809d7", "style": "IPY_MODEL_c32c33f9e88f46ab860c3696b23817da", "tooltip": ""}}, "ee39cbbfe3074105a5b4a3c4a670e24d": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_dd259832add24878be0123b2fc2e96ba", "placeholder": "\u200b", "style": "IPY_MODEL_1fa82df6757e4a18b37ed41fcba189ba", "value": "\n<b>Pro Tip:</b> If you don't already have one, you can create a dedicated\n'notebooks' token with 'write' access, that you can then easily reuse for all\nnotebooks. </center>"}}, "542a858390fd4e3b9ed42e840fac9ba6": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": "center", "align_self": null, "border": null, "bottom": null, "display": "flex", "flex": null, "flex_flow": "column", "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "50%"}}, "a08aa53f1c584b0295a91c8fca8ff10c": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1d164b6dd39a4a01b6f8fcddf60f7b6e": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "eae08d86d7ca42aa96c39793cea2fd3e": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5054de5a40e845bf9dead4791eca944d": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "e8e36b88a3b34e4385fb4e6fbd7eefc9": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "40c0df05655a414a8d4cea371f28fafb": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "484b5dc3b2f04749b58f4350167809d7": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c32c33f9e88f46ab860c3696b23817da": {"model_module": "@jupyter-widgets/controls", "model_name": "ButtonStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "dd259832add24878be0123b2fc2e96ba": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1fa82df6757e4a18b37ed41fcba189ba": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "f625228db81340c8a02e10530e36924e": {"model_module": "@jupyter-widgets/controls", "model_name": "LabelModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "LabelView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_852bd1eea9d74d6294619b5bf3c29d88", "placeholder": "\u200b", "style": "IPY_MODEL_6ca19f59553e4b3e86d699d215bae1ac", "value": "Connecting..."}}, "852bd1eea9d74d6294619b5bf3c29d88": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6ca19f59553e4b3e86d699d215bae1ac": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "fc9a982d520e405ebe6f7e4038be52f2": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_dec5343f490d4a37bb84513963c610b1", "IPY_MODEL_4c8f6d9e4eaf4a1783f2e6df10bda3dc", "IPY_MODEL_ff4919178bb745bc8b2703875a5ba7f6"], "layout": "IPY_MODEL_8af569fe9c834ef6b471c8cf63690ba7"}}, "dec5343f490d4a37bb84513963c610b1": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_57cb76d5f0cd447ba6d9db8019df25eb", "placeholder": "\u200b", "style": "IPY_MODEL_79fc1c0ea79e4bb6b388dc9930270945", "value": "Downloading\u2007result:\u2007100%"}}, "4c8f6d9e4eaf4a1783f2e6df10bda3dc": {"model_module": "@jupyter-widgets/controls", "model_name": "FloatProgressModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_0ae1e3a3c0de442b8320d3aa4e853901", "max": 10775209, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_6ff6c3a5d1384a598cbe2e82aee119be", "value": 10775209}}, "ff4919178bb745bc8b2703875a5ba7f6": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_acd47b2d5e1e48c88720507f5068be95", "placeholder": "\u200b", "style": "IPY_MODEL_16e782dfcffa4d889024df2a28ab9963", "value": "\u200710.8M/10.8M\u2007[00:00&lt;00:00,\u200749.8MB/s]"}}, "8af569fe9c834ef6b471c8cf63690ba7": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "57cb76d5f0cd447ba6d9db8019df25eb": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "79fc1c0ea79e4bb6b388dc9930270945": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "0ae1e3a3c0de442b8320d3aa4e853901": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6ff6c3a5d1384a598cbe2e82aee119be": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "acd47b2d5e1e48c88720507f5068be95": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "16e782dfcffa4d889024df2a28ab9963": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "b9c3b711250441febc5322ec5c9a1d3a": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_623430e3daab470b9ee2be9e0fc26240", "IPY_MODEL_81c5b0817f494a479fae0bc4ba9d11d9", "IPY_MODEL_6b23c858111743d3bce0d12189e571c3"], "layout": "IPY_MODEL_285fcf2441e240b586467dbed4096656"}}, "623430e3daab470b9ee2be9e0fc26240": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_358309e16439464e846e36b14cf88cc3", "placeholder": "\u200b", "style": "IPY_MODEL_dc7f9276e8404710aefd3059efccd3ac", "value": "Downloading\u2007result:\u2007100%"}}, "81c5b0817f494a479fae0bc4ba9d11d9": {"model_module": "@jupyter-widgets/controls", "model_name": "FloatProgressModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_f3c5269d10124774b79710a572d2eece", "max": 10775209, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_2748111fb2aa4096a3caa5d98327999c", "value": 10775209}}, "6b23c858111743d3bce0d12189e571c3": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_626081b8f7d4479bb3a6c70f4397324d", "placeholder": "\u200b", "style": "IPY_MODEL_0db968768acb4e0abf3840c372450d50", "value": "\u200710.8M/10.8M\u2007[00:00&lt;00:00,\u200749.5MB/s]"}}, "285fcf2441e240b586467dbed4096656": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "358309e16439464e846e36b14cf88cc3": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "dc7f9276e8404710aefd3059efccd3ac": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "f3c5269d10124774b79710a572d2eece": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2748111fb2aa4096a3caa5d98327999c": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "626081b8f7d4479bb3a6c70f4397324d": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0db968768acb4e0abf3840c372450d50": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "e5b91b551cde44c49ec62caa573f4580": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_eeca2c7207c44180a74231bebfd46bf7", "IPY_MODEL_36c47c84578c45f4b3a725bbf34e7d25", "IPY_MODEL_dfcf1f9999e44bb89511fbd774992cee"], "layout": "IPY_MODEL_44327db96c954732823aa1b96d1e9c8d"}}, "eeca2c7207c44180a74231bebfd46bf7": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_1e622f13b2534690bca082595b8be97a", "placeholder": "\u200b", "style": "IPY_MODEL_965f1d731dfd401096fa888b5c877993", "value": "Downloading\u2007result:\u2007100%"}}, "36c47c84578c45f4b3a725bbf34e7d25": {"model_module": "@jupyter-widgets/controls", "model_name": "FloatProgressModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_0939e4109925462db0c40edef8279b42", "max": 36092173, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_6ff9753c70a74dfb9bc211cc11faf05d", "value": 36092173}}, "dfcf1f9999e44bb89511fbd774992cee": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_0e9f895c324e4aeb8731e8f51945ec08", "placeholder": "\u200b", "style": "IPY_MODEL_62a8ff6f67744331ae2c8855c79f64b3", "value": "\u200736.1M/36.1M\u2007[00:00&lt;00:00,\u200744.9MB/s]"}}, "44327db96c954732823aa1b96d1e9c8d": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1e622f13b2534690bca082595b8be97a": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "965f1d731dfd401096fa888b5c877993": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "0939e4109925462db0c40edef8279b42": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6ff9753c70a74dfb9bc211cc11faf05d": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "0e9f895c324e4aeb8731e8f51945ec08": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "62a8ff6f67744331ae2c8855c79f64b3": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "0f7968f457a9487eba33047f43e26bba": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_f9c366e3efaf412cb540a113658733c4", "IPY_MODEL_10d56339766944da880c4398df089bd4", "IPY_MODEL_a6229aaca92c44a8a55cdee45391ea94"], "layout": "IPY_MODEL_daab77c9341a4962a16a703951a2c2ac"}}, "f9c366e3efaf412cb540a113658733c4": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_2344dd6e555c4f73b0b31244d392d860", "placeholder": "\u200b", "style": "IPY_MODEL_60f0f973a113401781d700a7d684f858", "value": "Downloading\u2007result:\u2007100%"}}, "10d56339766944da880c4398df089bd4": {"model_module": "@jupyter-widgets/controls", "model_name": "FloatProgressModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_68a9546180ea45439049c97bcebe0f81", "max": 10775209, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_0450670920554791a3a64839c3f7ec30", "value": 10775209}}, "a6229aaca92c44a8a55cdee45391ea94": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_ef4518468c024de9a371271ad699660f", "placeholder": "\u200b", "style": "IPY_MODEL_50d763b848264a3aa4627126e19007a3", "value": "\u200710.8M/10.8M\u2007[00:00&lt;00:00,\u200749.1MB/s]"}}, "daab77c9341a4962a16a703951a2c2ac": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2344dd6e555c4f73b0b31244d392d860": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "60f0f973a113401781d700a7d684f858": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "68a9546180ea45439049c97bcebe0f81": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0450670920554791a3a64839c3f7ec30": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "ef4518468c024de9a371271ad699660f": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "50d763b848264a3aa4627126e19007a3": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "ca7a3351d9944c6d95645eabc78aed57": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_f612ee833e9347399b8332e76312e8ba", "IPY_MODEL_b08bc9e9ec1a40458a5d88fecdf9c92b", "IPY_MODEL_ca36cfa3176a4ad59b46ed1507ba3732"], "layout": "IPY_MODEL_ff1383518c1949828842d7b8ad6f71c6"}}, "f612ee833e9347399b8332e76312e8ba": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_d5350b5bac5f4cff98734a941b4b697d", "placeholder": "\u200b", "style": "IPY_MODEL_663e6e6d417d46678b860c088c6749f1", "value": "Downloading\u2007result:\u2007100%"}}, "b08bc9e9ec1a40458a5d88fecdf9c92b": {"model_module": "@jupyter-widgets/controls", "model_name": "FloatProgressModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_6c28138052e847f09c0e531016ada90b", "max": 10775209, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_65359db59a034085a7b67bdcf056cadf", "value": 10775209}}, "ca36cfa3176a4ad59b46ed1507ba3732": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_1207161ca47a4ce09fce70532c484013", "placeholder": "\u200b", "style": "IPY_MODEL_52fdaae91ef8407f9f60e1c61980202f", "value": "\u200710.8M/10.8M\u2007[00:00&lt;00:00,\u200750.5MB/s]"}}, "ff1383518c1949828842d7b8ad6f71c6": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d5350b5bac5f4cff98734a941b4b697d": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "663e6e6d417d46678b860c088c6749f1": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "6c28138052e847f09c0e531016ada90b": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "65359db59a034085a7b67bdcf056cadf": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "1207161ca47a4ce09fce70532c484013": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "52fdaae91ef8407f9f60e1c61980202f": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "13fea3d178dd4759b6f25b66f34c9c4e": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_e28c91e356304371b26a5546247148bf", "IPY_MODEL_b57cddea8778476fa63bb69a5779221c", "IPY_MODEL_0e42d1c0acc140039cf95d2cc9ed270b"], "layout": "IPY_MODEL_628c4928dced4f0188a52a7bebd624f6"}}, "e28c91e356304371b26a5546247148bf": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_5a7c7089151a47a88da8af82cf124685", "placeholder": "\u200b", "style": "IPY_MODEL_0aa65b7d858b43f3ba43344502875e96", "value": "Downloading\u2007result:\u2007100%"}}, "b57cddea8778476fa63bb69a5779221c": {"model_module": "@jupyter-widgets/controls", "model_name": "FloatProgressModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_5b78a3110ed14457986690a584da1275", "max": 10775209, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_d59cf3b0f5a94a3593d567e5386464cf", "value": 10775209}}, "0e42d1c0acc140039cf95d2cc9ed270b": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_916072224bd04e92b97def308c9e27b6", "placeholder": "\u200b", "style": "IPY_MODEL_35cd2009f11e4eb1bc6612268b215212", "value": "\u200710.8M/10.8M\u2007[00:00&lt;00:00,\u200750.5MB/s]"}}, "628c4928dced4f0188a52a7bebd624f6": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5a7c7089151a47a88da8af82cf124685": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0aa65b7d858b43f3ba43344502875e96": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "5b78a3110ed14457986690a584da1275": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d59cf3b0f5a94a3593d567e5386464cf": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "916072224bd04e92b97def308c9e27b6": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "35cd2009f11e4eb1bc6612268b215212": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "c29a875ea327495d9e49d01b91ee89d7": {"model_module": "@jupyter-widgets/controls", "model_name": "HBoxModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_9d139b9de64741ffab0a4ae47b90679e", "IPY_MODEL_1b274644b7f54062aff5ef24a7a285ee", "IPY_MODEL_f2b1e1cdd01549fbb2684ddce04b7c0c"], "layout": "IPY_MODEL_a211c602ba6c4a2faf692df8fbd17321"}}, "9d139b9de64741ffab0a4ae47b90679e": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_db4e018a36fc490db5e6d4ce2e04896c", "placeholder": "\u200b", "style": "IPY_MODEL_9c8267ae219d470d90e03df4cd68360c", "value": "Downloading\u2007result:\u2007100%"}}, "1b274644b7f54062aff5ef24a7a285ee": {"model_module": "@jupyter-widgets/controls", "model_name": "FloatProgressModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_4b0106376af4432b82657da0b2284396", "max": 10775209, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_8182c4dc8f6d475ca492add35673686f", "value": 10775209}}, "f2b1e1cdd01549fbb2684ddce04b7c0c": {"model_module": "@jupyter-widgets/controls", "model_name": "HTMLModel", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_13eced3acad846b5a45c606be5e67fc5", "placeholder": "\u200b", "style": "IPY_MODEL_76af974682b84f98aac27faa71b0cac1", "value": "\u200710.8M/10.8M\u2007[00:00&lt;00:00,\u200748.5MB/s]"}}, "a211c602ba6c4a2faf692df8fbd17321": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "db4e018a36fc490db5e6d4ce2e04896c": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9c8267ae219d470d90e03df4cd68360c": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "4b0106376af4432b82657da0b2284396": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8182c4dc8f6d475ca492add35673686f": {"model_module": "@jupyter-widgets/controls", "model_name": "ProgressStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "13eced3acad846b5a45c606be5e67fc5": {"model_module": "@jupyter-widgets/base", "model_name": "LayoutModel", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "76af974682b84f98aac27faa71b0cac1": {"model_module": "@jupyter-widgets/controls", "model_name": "DescriptionStyleModel", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}}
</script></section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#0️⃣-Setup">0️⃣ Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#1️⃣-Information-flow">1️⃣ Information flow</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Activation-Patching">Activation Patching</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#2️⃣-Visualizing-activations">2️⃣ Visualizing activations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#3️⃣-Choosing-the-right-probe---linear-classifiers-vs.-difference-in-means">3️⃣ Choosing the right probe - linear classifiers vs. difference in means</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Logistic-regression-probe-(LR)">Logistic regression probe (LR)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Difference-in-means-probe-(aka.-mean-mass-/-MM)">Difference in means probe (aka. mean mass / MM)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#4️⃣-Difference-in-means-steering">4️⃣ Difference in means steering</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#➡️-Let's-scale-things-up!-Steering-Llama-70B-on-NDIF">➡️ Let’s scale things up! Steering Llama-70B on NDIF</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025 NDIF.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
   
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>